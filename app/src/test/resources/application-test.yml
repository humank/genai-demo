# Test Profile Configuration
# This configuration ensures tests run in isolation with minimal dependencies

spring:
  # Application Configuration
  application:
    name: genai-demo
  
  # Database Configuration - Use H2 in-memory for all tests
  datasource:
    url: jdbc:h2:mem:testdb;DB_CLOSE_DELAY=-1;DB_CLOSE_ON_EXIT=FALSE;MODE=PostgreSQL
    driver-class-name: org.h2.Driver
    username: sa
    password: ""
  
  # JPA Configuration for Tests
  jpa:
    database-platform: org.hibernate.dialect.H2Dialect
    hibernate:
      ddl-auto: create-drop
    show-sql: false
    properties:
      hibernate:
        cache:
          use_second_level_cache: false
        format_sql: false
  
  # Disable Flyway for tests
  flyway:
    enabled: false
  
  # H2 Console - Disabled for security in tests
  h2:
    console:
      enabled: false
  
  # Kafka Configuration - Disabled for tests
  kafka:
    bootstrap-servers: localhost:9092
    consumer:
      auto-offset-reset: earliest
    producer:
      key-serializer: org.apache.kafka.common.serialization.StringSerializer
      value-serializer: org.apache.kafka.common.serialization.StringSerializer
  
  # Performance optimizations for tests
  main:
    lazy-initialization: true
  
  # Exclude unnecessary auto-configurations
  autoconfigure:
    exclude:
      - org.springframework.boot.autoconfigure.flyway.FlywayAutoConfiguration
      - org.springframework.boot.autoconfigure.kafka.KafkaAutoConfiguration

# Logging Configuration for Tests
logging:
  level:
    org.springframework: WARN
    org.hibernate: WARN
    solid.humank.genaidemo: INFO
    org.springframework.web: INFO
    org.springframework.boot.autoconfigure: WARN

# Management Endpoints - Minimal for tests
management:
  endpoints:
    web:
      exposure:
        include: health
  endpoint:
    health:
      show-details: never
  metrics:
    enable:
      all: false

# Profile Configuration Properties
genai-demo:
  profile:
    name: test
    description: Test environment with isolated configuration
    features:
      h2Console: false
      debugLogging: false
      inMemoryEvents: true
      kafkaEvents: false

# Additional test configuration
info:
  app:
    version: 2.0.0

# Application Profile Validation
app:
  profile:
    validation:
      strict: false  # Disable strict validation in tests

# OpenAPI Configuration
springdoc:
  api-docs:
    enabled: true
    path: /v3/api-docs
  swagger-ui:
    enabled: true
    path: /swagger-ui.html