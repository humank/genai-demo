@startuml Infrastructure Layer Overview
!theme plain
skinparam classAttributeIconSize 0

title Infrastructure Layer Overview\nGenerated: 2025-09-24 12:16:34\n\n

package "Customer Infrastructure" {
  interface CustomerRepository <<Repository>> {
    +findById(): Optional<Customer>
    +findByEmail(): Optional<Customer>
    +findByMembershipLevel(): List<Customer>
    +findByBirthMonth(): List<Customer>
    +findNewMembers(): List<Customer>
    +... (4 more methods)
  }

  interface JpaCustomerRepository <<Repository>> {
    +findNewMembersSince(): List<JpaCustomerEntity> [Query]
    +findCustomerIds(): List<String> [Query]
    +findByEmail(): Optional<JpaCustomerEntity>
    +findByMembershipLevel(): List<JpaCustomerEntity>
    +findByBirthMonth(): List<JpaCustomerEntity>
    +... (3 more methods)
  }

  interface CustomerRepositoryAdapter <<Repository>> {
    +findById(): Optional<Customer>
    +findByEmail(): Optional<Customer>
    +findByMembershipLevel(): List<Customer>
    +findByBirthMonth(): List<Customer>
    +findNewMembers(): List<Customer>
    +... (4 more methods)
  }

  interface OptimisticLockingCustomerService <<Repository>> {
  }

  interface CustomerApplicationService <<Repository>> {
  }

}

package "Pricing Infrastructure" {
  interface PricingRuleRepository <<Repository>> {
    +findById(): Optional<PricingRule>
    +findByProductId(): List<PricingRule>
    +findByPromotionId(): List<PricingRule>
    +findActiveRules(): List<PricingRule>
    +findRulesValidAt(): List<PricingRule>
    +... (2 more methods)
  }

  interface CommissionService <<Repository>> {
  }

  interface JpaPricingRuleRepository <<Repository>> {
    +findRulesValidAt(): List<JpaPricingRuleEntity> [Query]
    +findByProductId(): List<JpaPricingRuleEntity>
    +findByPromotionId(): List<JpaPricingRuleEntity>
    +findByIsActiveTrue(): List<JpaPricingRuleEntity>
    +findRulesValidAt(): List<JpaPricingRuleEntity>
    +... (1 more methods)
  }

  interface PricingRuleRepositoryAdapter <<Repository>> {
    +findByProductId(): List<PricingRule>
    +findByPromotionId(): List<PricingRule>
    +findActiveRules(): List<PricingRule>
    +findRulesValidAt(): List<PricingRule>
    +findByProductCategory(): List<PricingRule>
  }

  interface PricingApplicationService <<Repository>> {
  }

}

package "Delivery Infrastructure" {
  interface DeliveryRepository <<Repository>> {
    +save(): Delivery
    +findById(): Optional<Delivery>
    +findByUUID(): Optional<Delivery>
    +findByOrderId(): Optional<Delivery>
    +findByStatus(): List<Delivery>
    +... (3 more methods)
  }

  interface DeliveryManagementService <<Repository>> {
  }

  interface DeliveryServiceImpl <<Repository>> {
  }

  interface JpaDeliveryRepository <<Repository>> {
    +findFailedDeliveries(): List<JpaDeliveryEntity> [Query]
    +findByOrderId(): Optional<JpaDeliveryEntity>
    +findByStatus(): List<JpaDeliveryEntity>
    +findFailedDeliveries(): List<JpaDeliveryEntity>
    +findDeliveriesForRedelivery(): List<JpaDeliveryEntity>
    +... (1 more methods)
  }

  interface DeliveryRepositoryAdapter <<Repository>> {
    +findByUUID(): Optional<Delivery>
    +findByOrderId(): Optional<Delivery>
    +findByStatus(): List<Delivery>
    +findFailedDeliveries(): List<Delivery>
    +findDeliveriesForRedelivery(): List<Delivery>
    +... (1 more methods)
  }

}

package "Shoppingcart Infrastructure" {
  interface ShoppingCartRepository <<Repository>> {
    +findByCustomerId(): Optional<ShoppingCart>
  }

  interface ShoppingCartDomainService <<Repository>> {
  }

  interface JpaShoppingCartRepository <<Repository>> {
    +findByCustomerId(): Optional<JpaShoppingCartEntity>
    +findByCustomerIdAndStatus(): Optional<JpaShoppingCartEntity>
    +findActiveCarts(): List<JpaShoppingCartEntity>
    +findAbandonedCartsBefore(): List<JpaShoppingCartEntity>
  }

  interface ShoppingCartRepositoryAdapter <<Repository>> {
    +findByCustomerId(): Optional<ShoppingCart>
  }

  interface ShoppingCartApplicationService <<Repository>> {
  }

}

package "Inventory Infrastructure" {
  interface InventoryRepository <<Repository>> {
    +findByProductId(): Optional<Inventory>
    +delete(): void
    +exists(): boolean
    +findByReservationId(): Optional<Inventory>
    +findBelowThreshold(): List<Inventory>
    +... (1 more methods)
  }

  interface InventoryDomainService <<Repository>> {
  }

  interface InventoryJpaConfig <<Repository>> {
  }

  interface JpaReservationRepository <<Repository>> {
    +findExpiredReservations(): List<JpaReservationEntity> [Query]
    +findByInventoryId(): List<JpaReservationEntity>
    +findByOrderId(): List<JpaReservationEntity>
    +findExpiredReservations(): List<JpaReservationEntity>
    +findByInventoryIdAndStatus(): List<JpaReservationEntity>
  }

  interface JpaInventoryRepository <<Repository>> {
    +findBelowThreshold(): List<JpaInventoryEntity> [Query]
    +findByReservationId(): Optional<JpaInventoryEntity> [Query]
    +findByOrderId(): List<JpaInventoryEntity> [Query]
    +findByProductId(): Optional<JpaInventoryEntity>
    +findBelowThreshold(): List<JpaInventoryEntity>
    +... (2 more methods)
  }

  interface InventoryRepositoryAdapter <<Repository>> {
    +findByProductId(): Optional<Inventory>
    +delete(): void
    +exists(): boolean
    +findByReservationId(): Optional<Inventory>
    +findBelowThreshold(): List<Inventory>
    +... (1 more methods)
  }

  interface InventoryPersistenceAdapter <<Repository>> {
    +save(): Inventory
    +findById(): Optional<Inventory>
    +findByProductId(): Optional<Inventory>
    +findAll(): List<Inventory>
    +delete(): void
    +... (4 more methods)
  }

}

package "Review Infrastructure" {
  interface ProductReviewRepository <<Repository>> {
    +findByProductId(): List<ProductReview>
    +findByReviewerId(): List<ProductReview>
    +findByStatus(): List<ProductReview>
    +findByProductIdAndReviewerId(): Optional<ProductReview>
    +findReportedReviews(): List<ProductReview>
  }

  interface JpaProductReviewRepository <<Repository>> {
    +findByProductId(): List<JpaProductReviewEntity>
    +findByReviewerId(): List<JpaProductReviewEntity>
    +findByStatus(): List<JpaProductReviewEntity>
    +findByProductIdAndReviewerId(): Optional<JpaProductReviewEntity>
    +findByIsReportedTrue(): List<JpaProductReviewEntity>
  }

  interface ProductReviewRepositoryAdapter <<Repository>> {
    +findByProductId(): List<ProductReview>
    +findByReviewerId(): List<ProductReview>
    +findByStatus(): List<ProductReview>
    +findByProductIdAndReviewerId(): Optional<ProductReview>
    +findReportedReviews(): List<ProductReview>
  }

}

package "Common Infrastructure" {
  interface BaseRepository <<Repository>> {
  }

  interface Repository <<Repository>> {
    +save(): T
    +findById(): Optional<T>
    +findAll(): List<T>
    +delete(): void
    +deleteById(): void
    +... (2 more methods)
  }

  interface RepositoryConfig <<Repository>> {
  }

  interface DeliveryServiceAdapter <<Repository>> {
  }

  interface JacksonJsonConverter <<Repository>> {
  }

  interface JsonConverter <<Repository>> {
  }

  interface JsonConversionException <<Repository>> {
  }

  interface StatisticsApplicationService <<Repository>> {
  }

}

package "Product Infrastructure" {
  interface ProductRepository <<Repository>> {
    +findById(): Optional<Product>
    +findByCategory(): List<Product>
    +findByName(): List<Product>
    +save(): Product
    +delete(): void
  }

  interface ProductJpaConfig <<Repository>> {
  }

  interface ProductJpaRepository <<Repository>> {
    +findByStatus(): List<ProductJpaEntity>
    +findByStatus(): Page<ProductJpaEntity>
    +findByNameContainingIgnoreCaseAndStatus(): List<ProductJpaEntity>
    +findByCategoryAndStatus(): List<ProductJpaEntity>
    +findByProductIdAndStatus(): Optional<ProductJpaEntity>
    +... (2 more methods)
  }

  interface ProductRepositoryAdapter <<Repository>> {
    +findById(): Optional<Product>
    +findByCategory(): List<Product>
    +findByName(): List<Product>
    +save(): Product
    +deleteById(): void
    +... (5 more methods)
  }

  interface ProductApplicationService <<Repository>> {
    +deleteProduct(): void
  }

}

package "Observability Infrastructure" {
  interface AnalyticsDataRepository <<Repository>> {
    +save(): AnalyticsSession
    +findBySessionId(): Optional<AnalyticsSession>
    +findByUserId(): List<AnalyticsSession>
    +delete(): void
  }

  interface TracingAspect <<Repository>> {
  }

  interface InMemoryAnalyticsEventRepository <<Repository>> {
    +findByUserIdAndTimestampBetween(): List<AnalyticsEventEntity>
    +findPerformanceEventsByPageAndTimeRange(): List<AnalyticsEventEntity>
    +findBusinessEventsByTimeRange(): List<AnalyticsEventEntity>
    +findByFrontendEventTypeAndTimestampBetween(): List<AnalyticsEventEntity>
    +findAll(): Page<AnalyticsEventEntity>
    +... (2 more methods)
  }

  interface AnalyticsEventRepository <<Repository>> {
    +findByUserIdAndTimestampBetween(): List<AnalyticsEventEntity>
    +findPerformanceEventsByPageAndTimeRange(): List<AnalyticsEventEntity>
    +findBusinessEventsByTimeRange(): List<AnalyticsEventEntity>
    +findByFrontendEventTypeAndTimestampBetween(): List<AnalyticsEventEntity>
    +findAll(): Page<AnalyticsEventEntity>
    +... (2 more methods)
  }

  interface AnalyticsSessionRepository <<Repository>> {
    +findByCreatedAtBetween(): List<AnalyticsSessionEntity>
  }

  interface InMemoryAnalyticsSessionRepository <<Repository>> {
    +findByCreatedAtBetween(): List<AnalyticsSessionEntity>
  }

  interface JpaAnalyticsSessionRepository <<Repository>> {
    +findByUserIdAndTimeRange(): List<JpaAnalyticsSessionEntity> [Query]
    +findAnonymousSessionsSince(): List<JpaAnalyticsSessionEntity> [Query]
    +findActiveSessionsSince(): List<JpaAnalyticsSessionEntity> [Query]
    +findSessionsPageable(): Page<JpaAnalyticsSessionEntity> [Query]
    +findExpiredSessions(): List<JpaAnalyticsSessionEntity> [Query]
    +... (16 more methods)
  }

  interface JpaAnalyticsEventRepository <<Repository>> {
    +findBySessionIdAndEventType(): List<JpaAnalyticsEventEntity> [Query]
    +findByTimeRange(): List<JpaAnalyticsEventEntity> [Query]
    +findEventsPageable(): Page<JpaAnalyticsEventEntity> [Query]
    +findPageViewEvents(): List<JpaAnalyticsEventEntity> [Query]
    +findUserActionEvents(): List<JpaAnalyticsEventEntity> [Query]
    +... (29 more methods)
  }

  interface AnalyticsDataRepositoryAdapter <<Repository>> {
    +save(): AnalyticsSession
    +findBySessionId(): Optional<AnalyticsSession>
    +findByUserId(): List<AnalyticsSession>
    +delete(): void
  }

  interface AnalyticsQueryService <<Repository>> {
  }

  interface DataRetentionService <<Repository>> {
  }

  interface AnalyticsQueryService <<Repository>> {
  }

}

package "Payment Infrastructure" {
  interface PaymentMethodRepository <<Repository>> {
    +findByCustomerId(): List<PaymentMethod>
    +findDefaultByCustomerId(): Optional<PaymentMethod>
    +findByCustomerIdAndType(): List<PaymentMethod>
    +findActiveByCustomerId(): List<PaymentMethod>
    +findByProvider(): List<PaymentMethod>
  }

  interface PaymentRepository <<Repository>> {
    +save(): Payment
    +findById(): Optional<Payment>
    +findByOrderId(): List<Payment>
    +findByOrderId(): List<Payment>
  }

  interface PaymentDomainService <<Repository>> {
  }

  interface Payment <<Repository>> {
  }

  interface PaymentJpaConfig <<Repository>> {
  }

  interface JpaPaymentMethodRepository <<Repository>> {
    +findByCustomerId(): List<JpaPaymentMethodEntity>
    +findByCustomerIdAndIsDefaultTrue(): Optional<JpaPaymentMethodEntity>
    +findByCustomerIdAndType(): List<JpaPaymentMethodEntity>
    +findByCustomerIdAndIsActiveTrue(): List<JpaPaymentMethodEntity>
    +findByProvider(): List<JpaPaymentMethodEntity>
  }

  interface JpaPaymentRepository <<Repository>> {
    +findByOrderId(): List<JpaPaymentEntity>
    +findById(): Optional<JpaPaymentEntity>
    +countByPaymentMethodGrouped(): List<Object[]>
  }

  interface PaymentMethodRepositoryAdapter <<Repository>> {
    +findByCustomerId(): List<PaymentMethod>
    +findDefaultByCustomerId(): Optional<PaymentMethod>
    +findByCustomerIdAndType(): List<PaymentMethod>
    +findActiveByCustomerId(): List<PaymentMethod>
    +findByProvider(): List<PaymentMethod>
  }

  interface PaymentPersistenceAdapter <<Repository>> {
    +save(): void
    +findById(): Optional<Payment>
    +findAll(): List<Payment>
    +delete(): void
    +exists(): boolean
    +... (1 more methods)
  }

  interface PaymentRepositoryAdapter <<Repository>> {
    +findByOrderId(): List<Payment>
    +findByOrderId(): List<Payment>
    +findByOrderId(): return
  }

}

package "Notification Infrastructure" {
  interface NotificationRepository <<Repository>> {
    +save(): Notification
    +findById(): Optional<Notification>
    +findByCustomerId(): List<Notification>
    +findByType(): List<Notification>
    +findByStatus(): List<Notification>
    +... (3 more methods)
  }

  interface NotificationTemplateRepository <<Repository>> {
    +findByTypeAndChannel(): Optional<NotificationTemplate>
    +findByType(): List<NotificationTemplate>
    +findByChannel(): List<NotificationTemplate>
    +findActiveTemplates(): List<NotificationTemplate>
    +findByNameContaining(): List<NotificationTemplate>
  }

  interface CustomerNotificationPreferenceRepository <<Repository>> {
    +findByCustomerId(): Optional<CustomerNotificationPreference>
    +deleteByCustomerId(): void
  }

  interface CustomerNotificationPreferenceService <<Repository>> {
  }

  interface NotificationScheduler <<Repository>> {
  }

  interface NotificationService <<Repository>> {
  }

  interface JpaNotificationTemplateRepository <<Repository>> {
    +findByTypeAndChannel(): Optional<JpaNotificationTemplateEntity>
    +findByType(): List<JpaNotificationTemplateEntity>
    +findByChannel(): List<JpaNotificationTemplateEntity>
    +findByIsActiveTrue(): List<JpaNotificationTemplateEntity>
    +findByNameContainingIgnoreCase(): List<JpaNotificationTemplateEntity>
  }

  interface JpaNotificationRepository <<Repository>> {
    +findPendingNotificationsScheduledBefore(): List<JpaNotificationEntity> [Query]
    +findFailedNotifications(): List<JpaNotificationEntity> [Query]
    +findNotificationsForRetry(): List<JpaNotificationEntity> [Query]
    +findByCustomerId(): List<JpaNotificationEntity>
    +findByType(): List<JpaNotificationEntity>
    +... (4 more methods)
  }

  interface NotificationTemplateRepositoryAdapter <<Repository>> {
    +findByTypeAndChannel(): Optional<NotificationTemplate>
    +findByType(): List<NotificationTemplate>
    +findByChannel(): List<NotificationTemplate>
    +findActiveTemplates(): List<NotificationTemplate>
    +findByNameContaining(): List<NotificationTemplate>
  }

  interface NotificationRepositoryAdapter <<Repository>> {
    +findByCustomerId(): List<Notification>
    +findByType(): List<Notification>
    +findByStatus(): List<Notification>
    +findPendingNotificationsScheduledBefore(): List<Notification>
    +findFailedNotifications(): List<Notification>
    +... (1 more methods)
  }

}

package "Order Infrastructure" {
  interface OrderRepository <<Repository>> {
    +save(): Order
    +findById(): Optional<Order>
    +findByCustomerId(): List<Order>
    +findByCustomerId(): List<Order>
  }

  interface OrderWorkflowRepository <<Repository>> {
    +save(): OrderWorkflow
    +findById(): Optional<OrderWorkflow>
    +findByOrderId(): Optional<OrderWorkflow>
    +findByStatus(): List<OrderWorkflow>
    +findByCreatedAtAfter(): List<OrderWorkflow>
    +... (2 more methods)
  }

  interface OrderWorkflowService <<Repository>> {
  }

  interface Order <<Repository>> {
  }

  interface OrderJpaConfig <<Repository>> {
  }

  interface JpaOrderWorkflowRepository <<Repository>> {
    +findByOrderId(): Optional<JpaOrderWorkflowEntity>
    +findByStatus(): List<JpaOrderWorkflowEntity>
    +findByCreatedAtAfter(): List<JpaOrderWorkflowEntity>
    +findByUpdatedAtAfter(): List<JpaOrderWorkflowEntity>
    +findCancelledWorkflows(): List<JpaOrderWorkflowEntity>
  }

  interface JpaOrderRepository <<Repository>> {
    +findDistinctCustomerIds(): List<String> [Query]
    +findByCustomerId(): List<JpaOrderEntity>
    +findById(): Optional<JpaOrderEntity>
    +countAllOrderItems(): long
    +countDistinctCustomers(): long
    +... (4 more methods)
  }

  interface OrderRepositoryAdapter <<Repository>> {
    +findByCustomerId(): List<Order>
    +findByCustomerId(): List<Order>
    +findByCustomerId(): return
  }

  interface OrderWorkflowRepositoryAdapter <<Repository>> {
    +findByOrderId(): Optional<OrderWorkflow>
    +findByStatus(): List<OrderWorkflow>
    +findByCreatedAtAfter(): List<OrderWorkflow>
    +findByUpdatedAtAfter(): List<OrderWorkflow>
    +findCancelledWorkflows(): List<OrderWorkflow>
  }

  interface OrderPersistenceAdapter <<Repository>> {
    +save(): void
    +findById(): Optional<Order>
    +findAll(): List<Order>
    +delete(): void
    +exists(): boolean
    +... (3 more methods)
  }

}

package "Promotion Infrastructure" {
  interface VoucherRepository <<Repository>> {
    +findById(): Optional<Voucher>
    +findByRedemptionCode(): Optional<Voucher>
    +findByCustomerId(): List<Voucher>
    +findValidVouchers(): List<Voucher>
    +save(): Voucher
    +... (1 more methods)
  }

  interface PromotionRepository <<Repository>> {
    +findById(): Optional<Promotion>
    +findByType(): List<Promotion>
    +findActivePromotions(): List<Promotion>
    +findPromotionsValidAt(): List<Promotion>
    +save(): Promotion
    +... (1 more methods)
  }

  interface VoucherDomainService <<Repository>> {
    +findBestVoucherCombination(): VoucherCombinationResult
  }

  interface PromotionService <<Repository>> {
  }

  interface JpaVoucherRepository <<Repository>> {
    +findByRedemptionCode(): Optional<JpaVoucherEntity>
    +findByOwnerId(): List<JpaVoucherEntity>
    +findByExpiresAtAfterAndStatus(): List<JpaVoucherEntity>
  }

  interface JpaPromotionRepository <<Repository>> {
    +findActivePromotions(): List<JpaPromotionEntity> [Query]
    +findByType(): List<JpaPromotionEntity>
    +findByStatus(): List<JpaPromotionEntity>
    +findActivePromotions(): List<JpaPromotionEntity>
    +findByTypeAndStatus(): List<JpaPromotionEntity>
  }

  interface VoucherRepositoryAdapter <<Repository>> {
    +findByRedemptionCode(): Optional<Voucher>
    +findByCustomerId(): List<Voucher>
    +findValidVouchers(): List<Voucher>
    +delete(): void
  }

  interface PromotionRepositoryAdapter <<Repository>> {
    +save(): Promotion
    +findByType(): List<Promotion>
    +findActivePromotions(): List<Promotion>
    +delete(): void
    +findPromotionsValidAt(): List<Promotion>
  }

  interface PromotionApplicationService <<Repository>> {
  }

}

package "Seller Infrastructure" {
  interface SellerRepository <<Repository>> {
    +findByEmail(): Optional<Seller>
    +findByPhone(): Optional<Seller>
    +findActiveSellers(): List<Seller>
    +findByNameContaining(): List<Seller>
    +findVerifiedSellers(): List<Seller>
    +... (3 more methods)
  }

  interface SellerProfileService <<Repository>> {
    +findProfileBySellerId(): Optional<Seller>
    +findVerifiedProfiles(): List<Seller>
    +findProfilesByRatingRange(): List<Seller>
    +findProfilesByVerificationStatus(): List<Seller>
  }

  interface JpaSellerRepository <<Repository>> {
    +findByEmail(): Optional<JpaSellerEntity>
    +findByPhone(): Optional<JpaSellerEntity>
    +findByIsActiveTrue(): List<JpaSellerEntity>
    +findByNameContainingIgnoreCase(): List<JpaSellerEntity>
    +findByIsVerifiedTrue(): List<JpaSellerEntity>
    +... (3 more methods)
  }

  interface SellerRepositoryAdapter <<Repository>> {
    +findByEmail(): Optional<Seller>
    +findByPhone(): Optional<Seller>
    +findActiveSellers(): List<Seller>
    +findByNameContaining(): List<Seller>
    +findVerifiedSellers(): List<Seller>
    +... (3 more methods)
  }

}


@enduml
