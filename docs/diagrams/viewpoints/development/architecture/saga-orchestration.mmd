sequenceDiagram
    participant Client
    participant OrderSaga as Order Processing Saga<br/>(Orchestrator)
    participant OrderService as Order Service
    participant PaymentService as Payment Service
    participant InventoryService as Inventory Service
    participant NotificationService as Notification Service
    participant EventBus as Event Bus<br/>(MSK)
    
    Note over OrderSaga: Saga Orchestration Pattern<br/>Centralized coordination of distributed transaction
    
    %% Happy Path - Successful Order Processing
    Client->>+OrderSaga: Create Order Request
    
    Note over OrderSaga: Step 1: Create Order
    OrderSaga->>+OrderService: Create Order
    OrderService->>EventBus: OrderCreated Event
    OrderService-->>-OrderSaga: Order Created
    
    Note over OrderSaga: Step 2: Reserve Inventory
    OrderSaga->>+InventoryService: Reserve Items
    InventoryService->>EventBus: InventoryReserved Event
    InventoryService-->>-OrderSaga: Items Reserved
    
    Note over OrderSaga: Step 3: Process Payment
    OrderSaga->>+PaymentService: Process Payment
    PaymentService->>EventBus: PaymentProcessed Event
    PaymentService-->>-OrderSaga: Payment Successful
    
    Note over OrderSaga: Step 4: Confirm Order
    OrderSaga->>+OrderService: Confirm Order
    OrderService->>EventBus: OrderConfirmed Event
    OrderService-->>-OrderSaga: Order Confirmed
    
    Note over OrderSaga: Step 5: Send Notification
    OrderSaga->>+NotificationService: Send Confirmation
    NotificationService->>EventBus: NotificationSent Event
    NotificationService-->>-OrderSaga: Notification Sent
    
    OrderSaga-->>-Client: Order Completed Successfully
    
    Note over OrderSaga,NotificationService: Compensation Flow (Failure Scenario)
    
    %% Compensation Flow - Payment Failure
    Client->>+OrderSaga: Create Order Request (Failure Case)
    
    OrderSaga->>+OrderService: Create Order
    OrderService-->>-OrderSaga: Order Created
    
    OrderSaga->>+InventoryService: Reserve Items
    InventoryService-->>-OrderSaga: Items Reserved
    
    OrderSaga->>+PaymentService: Process Payment
    PaymentService-->>-OrderSaga: Payment Failed ❌
    
    Note over OrderSaga: Compensation: Rollback in reverse order
    
    OrderSaga->>+InventoryService: Release Reserved Items
    InventoryService->>EventBus: InventoryReleased Event
    InventoryService-->>-OrderSaga: Items Released
    
    OrderSaga->>+OrderService: Cancel Order
    OrderService->>EventBus: OrderCancelled Event
    OrderService-->>-OrderSaga: Order Cancelled
    
    OrderSaga->>+NotificationService: Send Failure Notification
    NotificationService-->>-OrderSaga: Notification Sent
    
    OrderSaga-->>-Client: Order Failed - Compensated
    
    Note over OrderSaga: Saga State Management<br/>• STARTED → INVENTORY_RESERVED → PAYMENT_PROCESSED → ORDER_CONFIRMED → COMPLETED<br/>• Compensation: COMPENSATING → INVENTORY_RELEASED → ORDER_CANCELLED → COMPENSATED