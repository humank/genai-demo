@startuml circuit-breaker-states
!theme plain
title Circuit Breaker Pattern - State Transitions

state closed : Normal Operation\nRequests pass through\nFailures counted
state open : Fast Fail Mode\nRequests rejected\nTimeout period active  
state halfopen : Recovery Testing\nLimited requests\nTesting service health

[*] --> closed
closed --> open : Failure threshold exceeded
open --> halfopen : Timeout period expired
halfopen --> closed : Success threshold met
halfopen --> open : Failure detected

note right of closed
  - All requests pass through
  - Monitor failure rate
  - Count consecutive failures
end note

note right of open
  - Reject requests immediately
  - Return cached response or error
  - Wait for timeout period
end note

note right of halfopen
  - Allow limited test requests
  - Monitor success rate
  - Decide next state transition
end note

@enduml