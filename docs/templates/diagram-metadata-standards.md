# Diagram Metadata Standard Format\n\n## Overview\n\nThis document defines the metadata standard format for all diagram files in the project, including Mermaid, PlantUML, and Excalidraw diagram metadata specifications, ensuring diagram traceability, automated processing, and consistency management.\n\n<!-- \nNote: Mermaid Diagram Format Update\n- Old format: .mmd file references\n- New format: .md files with ```mermaid code blocks\n- Reason: GitHub native support, better readability and maintainability\n-->\n\n## General Diagram Metadata Standards\n\n### Basic Front Matter Format\n\n```yaml\n---\ntitle: \"Diagram Title\"\ntype: \"mermaid|plantuml|excalidraw\"\nformat: \"md|puml|excalidraw|png|svg|pdf\"\nviewpoint: \"functional|information|concurrency|development|deployment|operational|context\"\nperspective: [\"security\", \"performance\", \"availability\", \"evolution\", \"usability\", \"regulation\", \"location\", \"cost\"]\ndiagram_level: \"overview|detailed|conceptual|implementation\"\ntarget_audience: [\"architect\", \"developer\", \"stakeholder\", \"business\", \"operator\"]\ndescription: \"Detailed description and purpose of the diagram\"\nrelated_documents: [\"../viewpoints/functional/domain-model.md\", \"../perspectives/security/authentication.md\"]\nsource_file: \"diagram-source.md\"  # Note: Now using .md files with Mermaid code blocks\ngenerated_files: [\"diagram.svg\"]\ndependencies: [\"other-diagram.md\", \"reference-model.puml\"]\nlast_updated: \"YYYY-MM-DD\"\nversion: \"1.0\"\nauthor: \"Architecture Team\"\nauto_generated: true|false\ngeneration_source: \"code|manual|template|ai-assisted\"\ngeneration_trigger: \"code-change|manual-update|scheduled\"\nupdate_frequency: \"on-demand|daily|weekly|monthly\"\ncomplexity: \"low|medium|high\"\nmaintenance_priority: \"low|medium|high|critical\"\nmaintenance_notes: \"Maintenance instructions and notes\"\nreview_status: \"draft|reviewed|approved|deprecated\"\ntags: [\"tag1\", \"tag2\", \"tag3\"]\n---\n```\n\n### Detailed Field Descriptions\n\n#### Required Fields\n\n- **title**: Diagram title, should clearly describe the diagram content\n- **type**: Diagram type (mermaid, plantuml, excalidraw)\n- **format**: File format (md, puml, excalidraw, png, svg, pdf)\n- **description**: Detailed description and purpose of the diagram\n- **last_updated**: Last update date, format YYYY-MM-DD\n- **version**: Diagram version number, using semantic versioning\n- **author**: Diagram author or responsible team\n\n#### Optional Fields\n\n- **viewpoint**: Associated architectural viewpoint\n- **perspective**: Related architectural perspectives array\n- **diagram_level**: Diagram detail level\n- **target_audience**: Target audience array\n- **related_documents**: Relative paths to related documents\n- **source_file**: Original diagram file\n- **generated_files**: Other format files generated from source\n- **dependencies**: Dependencies on other diagrams or files\n- **auto_generated**: Whether automatically generated\n- **generation_source**: Generation source\n- **generation_trigger**: Generation trigger conditions\n- **update_frequency**: Update frequency\n- **complexity**: Diagram complexity\n- **maintenance_priority**: Maintenance priority\n- **maintenance_notes**: Maintenance notes\n- **review_status**: Review status\n- **tags**: Free tags\n\n## Mermaid Diagram Metadata Standards\n\n### Standard Format\n\n```yaml\n---\ntitle: \"System Architecture Overview\"\ntype: \"mermaid\"\nformat: \"md\"\nviewpoint: \"functional\"\nperspective: [\"security\", \"performance\"]\ndiagram_level: \"overview\"\ntarget_audience: [\"architect\", \"stakeholder\"]\ndescription: \"Shows the overall system architecture and relationships between main components\"\nmermaid_type: \"graph|flowchart|sequence|class|state|pie|journey|gantt|gitgraph\"\ndirection: \"TD|LR|BT|RL\"\ntheme: \"default|dark|forest|neutral\"\nrelated_documents: [\"../viewpoints/functional/system-overview.md\"]\nsource_file: \"system-architecture.md\"  # Note: Now using .md files with Mermaid code blocks\ngenerated_files: [\"system-architecture.svg\"]\nlast_updated: \"2025-01-21\"\nversion: \"1.2\"\nauthor: \"Architecture Team\"\nauto_generated: false\ngeneration_source: \"manual\"\nupdate_frequency: \"monthly\"\ncomplexity: \"medium\"\nmaintenance_priority: \"high\"\ngithub_integration: true\nlive_editor_url: \"https://mermaid.live/edit#...\"\ntags: [\"architecture\", \"overview\", \"system\"]\n---\n```\n\n### Mermaid-Specific Fields\n\n- **mermaid_type**: Mermaid diagram type\n- **direction**: Diagram direction (Top-Down, Left-Right, Bottom-Top, Right-Left)\n- **theme**: Mermaid theme\n- **github_integration**: Whether displayed directly in GitHub\n- **live_editor_url**: Mermaid Live Editor link\n\n### Example File Structure\n\n```markdown\n---\ntitle: \"Customer Management Flow\"\ntype: \"mermaid\"\nformat: \"md\"\nviewpoint: \"functional\"\nperspective: [\"usability\", \"security\"]\ndiagram_level: \"detailed\"\ntarget_audience: [\"developer\", \"business\"]\ndescription: \"Shows the complete flow of customer registration, verification, and management\"\nmermaid_type: \"flowchart\"\ndirection: \"TD\"\ntheme: \"default\"\nrelated_documents: [\"../viewpoints/functional/customer-management.md\"]\nsource_file: \"customer-flow.md\"  # Note: Now using .md files with Mermaid code blocks\ngenerated_files: [\"customer-flow.svg\"]\nlast_updated: \"2025-01-21\"\nversion: \"2.0\"\nauthor: \"Business Analysis Team\"\nauto_generated: false\ngeneration_source: \"manual\"\nupdate_frequency: \"on-demand\"\ncomplexity: \"medium\"\nmaintenance_priority: \"medium\"\ngithub_integration: true\ntags: [\"customer\", \"workflow\", \"business-process\"]\n---\n\n# Customer Management Flow\n\n```mermaid\nflowchart TD\n    A[Customer Registration] --> B{Validate Data}\n    B -->|Valid| C[Create Account]\n    B -->|Invalid| D[Show Error]\n    C --> E[Send Welcome Email]\n    D --> A\n```\n```\n\n## PlantUML Diagram Metadata Standards\n\n### Standard Format\n\n```yaml\n---\ntitle: \"Domain Model Class Diagram\"\ntype: \"plantuml\"\nformat: \"puml\"\nviewpoint: \"functional\"\nperspective: [\"evolution\", \"security\"]\ndiagram_level: \"detailed\"\ntarget_audience: [\"architect\", \"developer\"]\ndescription: \"Shows detailed design of domain model including aggregate roots, entities, and value objects\"\nplantuml_type: \"class|sequence|usecase|activity|component|deployment|state|object\"\nstyle_theme: \"plain|blueprint|sketchy|black-and-white\"\ninclude_files: [\"common-styles.puml\", \"color-scheme.puml\"]\nrelated_documents: [\"../viewpoints/functional/domain-model.md\"]\nsource_file: \"domain-model.puml\"\ngenerated_files: [\"domain-model.svg\"]\ndependencies: [\"value-objects.puml\", \"aggregates.puml\"]\nlast_updated: \"2025-01-21\"\nversion: \"3.1\"\nauthor: \"Domain Modeling Team\"\nauto_generated: false\ngeneration_source: \"code\"\ngeneration_trigger: \"code-change\"\nupdate_frequency: \"on-demand\"\ncomplexity: \"high\"\nmaintenance_priority: \"critical\"\nplantuml_server: \"https://www.plantuml.com/plantuml\"\ntags: [\"domain-model\", \"class-diagram\", \"ddd\"]\n---\n```\n\n### PlantUML-Specific Fields\n\n- **plantuml_type**: PlantUML diagram type\n- **style_theme**: Style theme\n- **include_files**: Included style or shared files\n- **plantuml_server**: PlantUML server used\n\n### Example File Structure\n\n```plantuml\n---\ntitle: \"Order Aggregate Root Design\"\ntype: \"plantuml\"\nformat: \"puml\"\nviewpoint: \"functional\"\nperspective: [\"performance\", \"evolution\"]\ndiagram_level: \"detailed\"\ntarget_audience: [\"developer\"]\ndescription: \"Shows detailed design of order aggregate root including entity relationships and business methods\"\nplantuml_type: \"class\"\nstyle_theme: \"plain\"\ninclude_files: [\"../styles/ddd-colors.puml\"]\nrelated_documents: [\"../viewpoints/functional/order-management.md\"]\nsource_file: \"order-aggregate.puml\"\ngenerated_files: [\"order-aggregate.svg\"]\nlast_updated: \"2025-01-21\"\nversion: \"2.3\"\nauthor: \"Development Team\"\nauto_generated: true\ngeneration_source: \"code\"\ngeneration_trigger: \"code-change\"\nupdate_frequency: \"on-demand\"\ncomplexity: \"high\"\nmaintenance_priority: \"high\"\ntags: [\"order\", \"aggregate\", \"ddd\", \"domain-model\"]\n---\n@startuml\n!include ../styles/ddd-colors.puml\n\nclass Order <<AggregateRoot>> {\n    -orderId: OrderId\n    -customerId: CustomerId\n    -orderItems: List<OrderItem>\n    -status: OrderStatus\n    --\n    +addItem(item: OrderItem): void\n    +removeItem(itemId: OrderItemId): void\n    +calculateTotal(): Money\n    +confirm(): void\n}\n\nclass OrderItem <<Entity>> {\n    -itemId: OrderItemId\n    -productId: ProductId\n    -quantity: Quantity\n    -price: Money\n}\n\nOrder ||--o{ OrderItem\n@enduml\n```\n\n## Excalidraw Diagram Metadata Standards\n\n### Standard Format\n\n```yaml\n---\ntitle: \"System Architecture Concept Diagram\"\ntype: \"excalidraw\"\nformat: \"excalidraw\"\nviewpoint: \"functional\"\nperspective: [\"usability\", \"evolution\"]\ndiagram_level: \"conceptual\"\ntarget_audience: [\"stakeholder\", \"business\"]\ndescription: \"Shows system architecture concept design in hand-drawn style for easy communication and understanding\"\nexcalidraw_version: \"0.17.0\"\ncanvas_size: \"1920x1080\"\nbackground_color: \"#ffffff\"\ngrid_enabled: true\ncollaboration_enabled: false\nrelated_documents: [\"../viewpoints/functional/system-concept.md\"]\nsource_file: \"system-concept.excalidraw\"\ngenerated_files: [\"system-concept.svg\"]\nmcp_generated: true\nmcp_prompt: \"Create a conceptual diagram showing the main system components and their relationships\"\nlast_updated: \"2025-01-21\"\nversion: \"1.0\"\nauthor: \"Architecture Team\"\nauto_generated: true\ngeneration_source: \"ai-assisted\"\ngeneration_trigger: \"manual-update\"\nupdate_frequency: \"monthly\"\ncomplexity: \"low\"\nmaintenance_priority: \"medium\"\nexcalidraw_url: \"https://excalidraw.com/#json=...\"\ntags: [\"concept\", \"architecture\", \"hand-drawn\"]\n---\n```\n\n### Excalidraw-Specific Fields\n\n- **excalidraw_version**: Excalidraw version\n- **canvas_size**: Canvas size\n- **background_color**: Background color\n- **grid_enabled**: Whether grid is enabled\n- **collaboration_enabled**: Whether collaboration is enabled\n- **mcp_generated**: Whether generated through MCP\n- **mcp_prompt**: Prompt used for MCP generation\n- **excalidraw_url**: Excalidraw online editor link\n\n## Diagram Generation and Conversion Metadata\n\n### Automatic Generation Configuration\n\n```yaml\n---\ntitle: \"Automatic Generation Configuration\"\ngeneration_config:\n  triggers:\n    - type: \"file_change\"\n      patterns: [\"**/*.java\", \"**/*.ts\"]\n      target_diagrams: [\"class-diagram.puml\", \"component-diagram.md\"]  # Note: Now using .md files with Mermaid code blocks\n    \n    - type: \"scheduled\"\n      cron: \"0 2 * * 1\"  # Every Monday at 2 AM\n      target_diagrams: [\"architecture-overview.md\"]  # Note: Now using .md files with Mermaid code blocks\n    \n    - type: \"manual\"\n      command: \"generate-diagrams\"\n      target_diagrams: [\"all\"]\n  \n  output_formats:\n    - format: \"png\"\n      resolution: \"300dpi\"\n      background: \"white\"\n    \n    - format: \"svg\"\n      optimize: true\n      embed_fonts: true\n  \n  post_processing:\n    - action: \"optimize_images\"\n      tools: [\"optipng\", \"svgo\"]\n    \n    - action: \"update_references\"\n      scan_patterns: [\"**/*.md\"]\n---\n```\n\n### Version Control Metadata\n\n```yaml\n---\ntitle: \"Diagram Version Control\"\nversion_control:\n  versioning_strategy: \"semantic\"  # semantic|timestamp|sequential\n  \n  change_tracking:\n    - field: \"content_hash\"\n      algorithm: \"sha256\"\n    \n    - field: \"visual_diff\"\n      enabled: true\n      threshold: 0.1\n  \n  backup_strategy:\n    - frequency: \"daily\"\n      retention: \"30 days\"\n      location: \"backups/diagrams/\"\n    \n    - frequency: \"major_version\"\n      retention: \"1 year\"\n      location: \"archives/diagrams/\"\n  \n  approval_workflow:\n    - stage: \"draft\"\n      auto_approve: false\n    \n    - stage: \"review\"\n      reviewers: [\"architect\", \"domain-expert\"]\n      approval_threshold: 2\n    \n    - stage: \"approved\"\n      auto_publish: true\n---\n```\n\n## Diagram Quality and Maintenance Metadata\n\n### Quality Metrics\n\n```yaml\n---\ntitle: \"Diagram Quality Metrics\"\nquality_metrics:\n  readability:\n    font_size_min: 12\n    contrast_ratio_min: 4.5\n    element_spacing_min: 10\n  \n  complexity:\n    max_elements: 50\n    max_connections: 100\n    max_nesting_levels: 5\n  \n  consistency:\n    color_palette: \"standard\"\n    naming_convention: \"camelCase\"\n    style_guide: \"corporate\"\n  \n  accessibility:\n    alt_text_required: true\n    color_blind_friendly: true\n    screen_reader_compatible: true\n---\n```\n\n### Maintenance Schedule\n\n```yaml\n---\ntitle: \"Diagram Maintenance Schedule\"\nmaintenance_schedule:\n  regular_review:\n    frequency: \"quarterly\"\n    checklist:\n      - \"Check accuracy against current implementation\"\n      - \"Verify all references are valid\"\n      - \"Update styling to current standards\"\n      - \"Validate accessibility compliance\"\n  \n  dependency_check:\n    frequency: \"monthly\"\n    automated: true\n    actions:\n      - \"Scan for broken references\"\n      - \"Check file existence\"\n      - \"Validate metadata consistency\"\n  \n  performance_optimization:\n    frequency: \"bi-annually\"\n    targets:\n      - \"Reduce file sizes\"\n      - \"Optimize rendering performance\"\n      - \"Update to latest tool versions\"\n---\n```\n\n## Diagram Indexing and Search Metadata\n\n### Search Index Configuration\n\n```yaml\n---\ntitle: \"Diagram Search Index\"\nsearch_index:\n  indexable_fields:\n    - \"title\"\n    - \"description\"\n    - \"tags\"\n    - \"viewpoint\"\n    - \"perspective\"\n    - \"target_audience\"\n  \n  search_weights:\n    title: 3.0\n    description: 2.0\n    tags: 1.5\n    viewpoint: 1.0\n    perspective: 1.0\n  \n  faceted_search:\n    - field: \"viewpoint\"\n      display_name: \"Architectural Viewpoint\"\n    \n    - field: \"perspective\"\n      display_name: \"Architectural Perspective\"\n    \n    - field: \"type\"\n      display_name: \"Diagram Type\"\n    \n    - field: \"complexity\"\n      display_name: \"Complexity\"\n---\n```\n\n### Relationship Analysis\n\n```yaml\n---\ntitle: \"Diagram Relationship Analysis\"\nrelationship_analysis:\n  similarity_metrics:\n    - type: \"content_similarity\"\n      algorithm: \"cosine\"\n      threshold: 0.7\n    \n    - type: \"structural_similarity\"\n      algorithm: \"graph_edit_distance\"\n      threshold: 0.8\n  \n  clustering:\n    - method: \"hierarchical\"\n      distance_metric: \"euclidean\"\n      linkage: \"ward\"\n    \n    - method: \"k_means\"\n      k: \"auto\"\n      max_k: 10\n  \n  recommendation_engine:\n    - strategy: \"collaborative_filtering\"\n      weight: 0.4\n    \n    - strategy: \"content_based\"\n      weight: 0.6\n---\n```\n\n## Tool Integration and Automation\n\n### CI/CD Integration\n\n```yaml\n---\ntitle: \"CI/CD Diagram Processing\"\ncicd_integration:\n  validation_pipeline:\n    - stage: \"metadata_validation\"\n      tools: [\"yaml-lint\", \"custom-validator\"]\n    \n    - stage: \"diagram_compilation\"\n      tools: [\"plantuml\", \"mermaid-cli\", \"excalidraw-cli\"]\n    \n    - stage: \"quality_check\"\n      tools: [\"image-optimizer\", \"accessibility-checker\"]\n    \n    - stage: \"deployment\"\n      actions: [\"upload-to-cdn\", \"update-references\"]\n  \n  automation_triggers:\n    - event: \"pull_request\"\n      actions: [\"validate\", \"preview_generation\"]\n    \n    - event: \"merge_to_main\"\n      actions: [\"full_generation\", \"deployment\"]\n    \n    - event: \"scheduled\"\n      cron: \"0 3 * * *\"\n      actions: [\"maintenance_check\", \"optimization\"]\n---\n```\n\n### Monitoring and Alerting\n\n```yaml\n---\ntitle: \"Diagram Monitoring Configuration\"\nmonitoring:\n  health_checks:\n    - metric: \"generation_success_rate\"\n      threshold: 0.95\n      alert_level: \"warning\"\n    \n    - metric: \"file_size_growth\"\n      threshold: \"20%\"\n      period: \"monthly\"\n      alert_level: \"info\"\n    \n    - metric: \"broken_references\"\n      threshold: 0\n      alert_level: \"critical\"\n  \n  performance_metrics:\n    - metric: \"generation_time\"\n      target: \"< 30s\"\n    \n    - metric: \"file_size\"\n      target: \"< 1MB\"\n    \n    - metric: \"load_time\"\n      target: \"< 3s\"\n  \n  alerting:\n    channels: [\"slack\", \"email\"]\n    escalation_policy: \"standard\"\n    notification_frequency: \"immediate\"\n---\n```\n\nThis standard format ensures consistent diagram management, automated processing, and quality control while supporting the specific needs of different diagram tool types."