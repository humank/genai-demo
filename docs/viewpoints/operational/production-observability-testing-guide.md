# ç”Ÿç”¢ç’°å¢ƒå¯è§€æ¸¬æ€§æ¸¬è©¦æŒ‡å—

## ğŸ“‹ ç›®éŒ„

1. [æ¦‚è¿°](#æ¦‚è¿°)
2. [æ¸¬è©¦ç›®æ¨™](#æ¸¬è©¦ç›®æ¨™)
3. [æ¸¬è©¦æ¶æ§‹](#æ¸¬è©¦æ¶æ§‹)
4. [æ ¸å¿ƒæ¸¬è©¦å ´æ™¯](#æ ¸å¿ƒæ¸¬è©¦å ´æ™¯)
5. [æ¸¬è©¦ç’°å¢ƒé…ç½®](#æ¸¬è©¦ç’°å¢ƒé…ç½®)
6. [æ¸¬è©¦åŸ·è¡Œè¨ˆåŠƒ](#æ¸¬è©¦åŸ·è¡Œè¨ˆåŠƒ)
7. [é©—æ”¶æ¨™æº–](#é©—æ”¶æ¨™æº–)
8. [æ•…éšœæ’é™¤](#æ•…éšœæ’é™¤)
9. [æœ€ä½³å¯¦è¸](#æœ€ä½³å¯¦è¸)

## æ¦‚è¿°

æœ¬æ–‡ä»¶æä¾›äº†åœ¨ç”Ÿç”¢ç’°å¢ƒä¸­å¯¦æ–½å®Œæ•´å¯è§€æ¸¬æ€§ç³»çµ±çš„è©³ç´°æ¸¬è©¦æŒ‡å—ã€‚åŸºæ–¼ GenAI Demo é …ç›®çš„å¯è§€æ¸¬æ€§æ¸¬è©¦ç¶“é©—ï¼Œæ¶µè“‹æ—¥èªŒã€æŒ‡æ¨™ã€è¿½è¹¤ã€å¥åº·æª¢æŸ¥ç­‰å…¨æ–¹ä½çš„å¯è§€æ¸¬æ€§é©—è­‰ã€‚

### é©ç”¨ç¯„åœ

- **ç›®æ¨™ç’°å¢ƒ**: AWS ç”Ÿç”¢ç’°å¢ƒ
- **æŠ€è¡“æ£§**: Spring Boot 3.x + Java 21 + AWS å¯è§€æ¸¬æ€§æœå‹™
- **æ¸¬è©¦é¡å‹**: åŠŸèƒ½æ¸¬è©¦ã€æ€§èƒ½æ¸¬è©¦ã€ç½é›£æ¢å¾©æ¸¬è©¦
- **æ¸¬è©¦å±¤ç´š**: å–®å…ƒæ¸¬è©¦ã€é›†æˆæ¸¬è©¦ã€ç«¯åˆ°ç«¯æ¸¬è©¦

## æ¸¬è©¦ç›®æ¨™

### ğŸ¯ ä¸»è¦ç›®æ¨™

1. **å¯è§€æ¸¬æ€§å®Œæ•´æ€§é©—è­‰**
   - ç¢ºä¿æ‰€æœ‰å¯è§€æ¸¬æ€§çµ„ä»¶æ­£å¸¸é‹ä½œ
   - é©—è­‰æ•¸æ“šæµå®Œæ•´æ€§å’Œæº–ç¢ºæ€§
   - ç¢ºä¿è·¨æœå‹™è¿½è¹¤åŠŸèƒ½æ­£å¸¸

2. **æ€§èƒ½èˆ‡å¯é æ€§é©—è­‰**
   - é©—è­‰å¯è§€æ¸¬æ€§ç³»çµ±åœ¨é«˜è² è¼‰ä¸‹çš„ç©©å®šæ€§
   - ç¢ºä¿å¯è§€æ¸¬æ€§é–‹éŠ·åœ¨å¯æ¥å—ç¯„åœå…§ (< 5%)
   - é©—è­‰ç³»çµ±æ¢å¾©èƒ½åŠ›

3. **å®‰å…¨èˆ‡åˆè¦æ€§é©—è­‰**
   - ç¢ºä¿æ•æ„Ÿæ•¸æ“šæ­£ç¢ºé®ç½©
   - é©—è­‰æ•¸æ“šä¿ç•™æ”¿ç­–
   - ç¢ºä¿å¯©è¨ˆæ—¥èªŒå®Œæ•´æ€§

4. **æˆæœ¬å„ªåŒ–é©—è­‰**
   - é©—è­‰æ¡æ¨£ç­–ç•¥æœ‰æ•ˆæ€§
   - ç¢ºä¿è³‡æºä½¿ç”¨å„ªåŒ–
   - é©—è­‰æˆæœ¬ç›£æ§å’Œå‘Šè­¦

## æ¸¬è©¦æ¶æ§‹

### ğŸ—ï¸ å¯è§€æ¸¬æ€§æŠ€è¡“æ£§

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    ç”Ÿç”¢ç’°å¢ƒå¯è§€æ¸¬æ€§æ¶æ§‹                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  æ‡‰ç”¨å±¤                                                      â”‚
â”‚  â”œâ”€â”€ Spring Boot Actuator (å¥åº·æª¢æŸ¥ã€æŒ‡æ¨™)                   â”‚
â”‚  â”œâ”€â”€ Micrometer (æŒ‡æ¨™æ”¶é›†)                                   â”‚
â”‚  â”œâ”€â”€ OpenTelemetry (åˆ†æ•£å¼è¿½è¹¤)                              â”‚
â”‚  â””â”€â”€ Logback + MDC (çµæ§‹åŒ–æ—¥èªŒ)                              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  AWS å¯è§€æ¸¬æ€§æœå‹™                                            â”‚
â”‚  â”œâ”€â”€ CloudWatch (æŒ‡æ¨™ã€æ—¥èªŒã€å‘Šè­¦)                           â”‚
â”‚  â”œâ”€â”€ X-Ray (åˆ†æ•£å¼è¿½è¹¤)                                      â”‚
â”‚  â”œâ”€â”€ CloudWatch Insights (æ—¥èªŒåˆ†æ)                          â”‚
â”‚  â””â”€â”€ CloudWatch Dashboards (å¯è¦–åŒ–)                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  ç¬¬ä¸‰æ–¹å·¥å…· (å¯é¸)                                           â”‚
â”‚  â”œâ”€â”€ Prometheus + Grafana                                   â”‚
â”‚  â”œâ”€â”€ ELK Stack (Elasticsearch, Logstash, Kibana)           â”‚
â”‚  â””â”€â”€ Jaeger (è¿½è¹¤å¯è¦–åŒ–)                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## æ ¸å¿ƒæ¸¬è©¦å ´æ™¯

### ğŸ” 1. åŸºç¤å¯è§€æ¸¬æ€§é©—è­‰

#### 1.1 çµæ§‹åŒ–æ—¥èªŒæ¸¬è©¦

**æ¸¬è©¦ç›®æ¨™**: é©—è­‰çµæ§‹åŒ–æ—¥èªŒè¨˜éŒ„å’Œ MDC ä¸Šä¸‹æ–‡å‚³æ’­

**æ¸¬è©¦å ´æ™¯**:

```java
// å ´æ™¯ 1: MDC ä¸Šä¸‹æ–‡å‚³æ’­æ¸¬è©¦
@Test
void shouldPropagateCorrelationIdThroughMDC() {
    // Given: è¨­ç½®é—œè¯ ID
    String correlationId = "prod-test-" + System.currentTimeMillis();
    MDC.put("correlationId", correlationId);
    MDC.put("userId", "test-user-123");
    MDC.put("requestId", "req-" + UUID.randomUUID());
    
    // When: åŸ·è¡Œæ¥­å‹™æ“ä½œ
    performBusinessOperation();
    
    // Then: é©—è­‰æ—¥èªŒåŒ…å«æ­£ç¢ºçš„ä¸Šä¸‹æ–‡
    assertThat(getLogEntries())
        .allMatch(entry -> entry.contains(correlationId))
        .allMatch(entry -> entry.contains("test-user-123"));
}

// å ´æ™¯ 2: è·¨æœå‹™æ—¥èªŒé—œè¯æ¸¬è©¦
@Test
void shouldMaintainCorrelationAcrossServices() {
    // Given: ç™¼èµ·è·¨æœå‹™è«‹æ±‚
    String correlationId = generateCorrelationId();
    
    // When: èª¿ç”¨å¤šå€‹å¾®æœå‹™
    callOrderService(correlationId);
    callPaymentService(correlationId);
    callInventoryService(correlationId);
    
    // Then: é©—è­‰æ‰€æœ‰æœå‹™æ—¥èªŒéƒ½åŒ…å«ç›¸åŒçš„é—œè¯ ID
    assertThat(getAllServiceLogs())
        .allMatch(log -> log.getCorrelationId().equals(correlationId));
}
```

**é©—æ”¶æ¨™æº–**:

- âœ… æ‰€æœ‰æ—¥èªŒæ¢ç›®åŒ…å«å¿…è¦çš„ MDC ä¸Šä¸‹æ–‡
- âœ… é—œè¯ ID åœ¨æ•´å€‹è«‹æ±‚ç”Ÿå‘½é€±æœŸä¸­ä¿æŒä¸€è‡´
- âœ… æ—¥èªŒæ ¼å¼ç¬¦åˆ JSON çµæ§‹åŒ–æ¨™æº–
- âœ… æ•æ„Ÿä¿¡æ¯æ­£ç¢ºé®ç½© (PII, å¯†ç¢¼ç­‰)

#### 1.2 æŒ‡æ¨™æ”¶é›†æ¸¬è©¦

**æ¸¬è©¦ç›®æ¨™**: é©—è­‰æ¥­å‹™æŒ‡æ¨™å’Œç³»çµ±æŒ‡æ¨™çš„æº–ç¢ºæ”¶é›†

**æ¸¬è©¦å ´æ™¯**:

```java
// å ´æ™¯ 1: æ¥­å‹™æŒ‡æ¨™æ¸¬è©¦
@Test
void shouldCollectBusinessMetrics() {
    // Given: åˆå§‹æŒ‡æ¨™ç‹€æ…‹
    double initialOrderCount = getMetricValue("orders.created.total");
    double initialRevenue = getMetricValue("revenue.total");
    
    // When: åŸ·è¡Œæ¥­å‹™æ“ä½œ
    createOrder(OrderBuilder.newOrder()
        .withAmount(BigDecimal.valueOf(100.00))
        .withCustomerId("customer-123")
        .build());
    
    // Then: é©—è­‰æŒ‡æ¨™æ›´æ–°
    await().atMost(30, SECONDS).untilAsserted(() -> {
        assertThat(getMetricValue("orders.created.total"))
            .isEqualTo(initialOrderCount + 1);
        assertThat(getMetricValue("revenue.total"))
            .isEqualTo(initialRevenue + 100.00);
    });
}

// å ´æ™¯ 2: ç³»çµ±æŒ‡æ¨™æ¸¬è©¦
@Test
void shouldCollectSystemMetrics() {
    // When: ç³»çµ±é‹è¡Œä¸€æ®µæ™‚é–“
    generateSystemLoad();
    
    // Then: é©—è­‰ç³»çµ±æŒ‡æ¨™å¯ç”¨
    assertThat(getMetricValue("jvm.memory.used")).isGreaterThan(0);
    assertThat(getMetricValue("jvm.gc.pause")).isGreaterThan(0);
    assertThat(getMetricValue("http.server.requests")).isGreaterThan(0);
    assertThat(getMetricValue("database.connections.active")).isGreaterThan(0);
}
```

**é©—æ”¶æ¨™æº–**:

- âœ… æ¥­å‹™æŒ‡æ¨™æº–ç¢ºåæ˜ å¯¦éš›æ“ä½œ
- âœ… ç³»çµ±æŒ‡æ¨™æ¶µè“‹ JVMã€HTTPã€æ•¸æ“šåº«ç­‰é—œéµçµ„ä»¶
- âœ… æŒ‡æ¨™æ¨™ç±¤ (tags) æ­£ç¢ºè¨­ç½®
- âœ… æŒ‡æ¨™æ•¸æ“šåœ¨ Prometheus/CloudWatch ä¸­å¯æŸ¥è©¢

#### 1.3 åˆ†æ•£å¼è¿½è¹¤æ¸¬è©¦

**æ¸¬è©¦ç›®æ¨™**: é©—è­‰è·¨æœå‹™è«‹æ±‚è¿½è¹¤çš„å®Œæ•´æ€§

**æ¸¬è©¦å ´æ™¯**:

```java
// å ´æ™¯ 1: å–®ä¸€æœå‹™è¿½è¹¤æ¸¬è©¦
@Test
void shouldCreateTraceForSingleService() {
    // Given: å•Ÿç”¨è¿½è¹¤
    Span parentSpan = tracer.nextSpan().name("test-operation").start();
    
    try (Tracer.SpanInScope ws = tracer.withSpanInScope(parentSpan)) {
        // When: åŸ·è¡Œæ¥­å‹™æ“ä½œ
        String result = orderService.createOrder(createOrderRequest());
        
        // Then: é©—è­‰ span å‰µå»º
        assertThat(result).isNotNull();
        assertThat(parentSpan.getTraceId()).isNotNull();
        assertThat(parentSpan.getSpanId()).isNotNull();
    } finally {
        parentSpan.end();
    }
}

// å ´æ™¯ 2: è·¨æœå‹™è¿½è¹¤æ¸¬è©¦
@Test
void shouldTraceAcrossMultipleServices() {
    // Given: ç”Ÿæˆè¿½è¹¤ ID
    String traceId = generateTraceId();
    
    // When: åŸ·è¡Œè·¨æœå‹™æ“ä½œ
    HttpHeaders headers = new HttpHeaders();
    headers.set("X-Trace-ID", traceId);
    
    ResponseEntity<OrderResponse> response = restTemplate.exchange(
        "/api/orders", HttpMethod.POST, 
        new HttpEntity<>(createOrderRequest(), headers),
        OrderResponse.class
    );
    
    // Then: é©—è­‰è¿½è¹¤æ•¸æ“š
    await().atMost(60, SECONDS).untilAsserted(() -> {
        List<Span> spans = getSpansForTrace(traceId);
        assertThat(spans).hasSizeGreaterThan(3); // Order, Payment, Inventory services
        assertThat(spans).allMatch(span -> span.getTraceId().equals(traceId));
    });
}
```

**é©—æ”¶æ¨™æº–**:

- âœ… æ¯å€‹è«‹æ±‚éƒ½æœ‰å”¯ä¸€çš„è¿½è¹¤ ID
- âœ… è·¨æœå‹™èª¿ç”¨ä¿æŒè¿½è¹¤ä¸Šä¸‹æ–‡
- âœ… Span åŒ…å«å¿…è¦çš„æ¨™ç±¤å’Œå±¬æ€§
- âœ… è¿½è¹¤æ•¸æ“šåœ¨ X-Ray/Jaeger ä¸­å¯è¦–åŒ–

### ğŸ¥ 2. å¥åº·æª¢æŸ¥èˆ‡ç›£æ§æ¸¬è©¦

#### 2.1 æ‡‰ç”¨å¥åº·æª¢æŸ¥æ¸¬è©¦

**æ¸¬è©¦ç›®æ¨™**: é©—è­‰æ‡‰ç”¨å’Œä¾è³´æœå‹™çš„å¥åº·ç‹€æ…‹ç›£æ§

**æ¸¬è©¦å ´æ™¯**:

```java
// å ´æ™¯ 1: åŸºæœ¬å¥åº·æª¢æŸ¥æ¸¬è©¦
@Test
void shouldReturnHealthyStatusWhenAllComponentsUp() {
    // When: æŸ¥è©¢å¥åº·ç‹€æ…‹
    ResponseEntity<HealthResponse> response = restTemplate.getForEntity(
        "/actuator/health", HealthResponse.class);
    
    // Then: é©—è­‰å¥åº·ç‹€æ…‹
    assertThat(response.getStatusCode()).isEqualTo(HttpStatus.OK);
    assertThat(response.getBody().getStatus()).isEqualTo("UP");
    assertThat(response.getBody().getComponents())
        .containsKeys("db", "diskSpace", "redis", "kafka");
}

// å ´æ™¯ 2: ä¾è³´æœå‹™æ•…éšœæ¸¬è©¦
@Test
void shouldReturnUnhealthyWhenDependencyDown() {
    // Given: æ¨¡æ“¬æ•¸æ“šåº«æ•…éšœ
    simulateDatabaseFailure();
    
    // When: æŸ¥è©¢å¥åº·ç‹€æ…‹
    ResponseEntity<HealthResponse> response = restTemplate.getForEntity(
        "/actuator/health", HealthResponse.class);
    
    // Then: é©—è­‰ä¸å¥åº·ç‹€æ…‹
    assertThat(response.getStatusCode()).isEqualTo(HttpStatus.SERVICE_UNAVAILABLE);
    assertThat(response.getBody().getStatus()).isEqualTo("DOWN");
    assertThat(response.getBody().getComponents().get("db").getStatus())
        .isEqualTo("DOWN");
}
```

#### 2.2 Kubernetes æ¢é‡æ¸¬è©¦

**æ¸¬è©¦ç›®æ¨™**: é©—è­‰ Kubernetes liveness å’Œ readiness æ¢é‡

**æ¸¬è©¦å ´æ™¯**:

```java
// å ´æ™¯ 1: Liveness æ¢é‡æ¸¬è©¦
@Test
void shouldRespondToLivenessProbe() {
    // When: æŸ¥è©¢ liveness æ¢é‡
    ResponseEntity<String> response = restTemplate.getForEntity(
        "/actuator/health/liveness", String.class);
    
    // Then: é©—è­‰éŸ¿æ‡‰
    assertThat(response.getStatusCode()).isEqualTo(HttpStatus.OK);
    assertThat(response.getBody()).contains("\"status\":\"UP\"");
}

// å ´æ™¯ 2: Readiness æ¢é‡æ¸¬è©¦
@Test
void shouldRespondToReadinessProbe() {
    // When: æŸ¥è©¢ readiness æ¢é‡
    ResponseEntity<String> response = restTemplate.getForEntity(
        "/actuator/health/readiness", String.class);
    
    // Then: é©—è­‰éŸ¿æ‡‰
    assertThat(response.getStatusCode()).isEqualTo(HttpStatus.OK);
    assertThat(response.getBody()).contains("\"status\":\"UP\"");
}
```

**é©—æ”¶æ¨™æº–**:

- âœ… å¥åº·æª¢æŸ¥éŸ¿æ‡‰æ™‚é–“ < 5 ç§’
- âœ… Liveness æ¢é‡éŸ¿æ‡‰æ™‚é–“ < 2 ç§’
- âœ… Readiness æ¢é‡éŸ¿æ‡‰æ™‚é–“ < 3 ç§’
- âœ… ä¾è³´æœå‹™æ•…éšœæ™‚æ­£ç¢ºå ±å‘Šä¸å¥åº·ç‹€æ…‹

### ğŸš€ 3. æ€§èƒ½èˆ‡è² è¼‰æ¸¬è©¦

#### 3.1 å¯è§€æ¸¬æ€§é–‹éŠ·æ¸¬è©¦

**æ¸¬è©¦ç›®æ¨™**: é©—è­‰å¯è§€æ¸¬æ€§ç³»çµ±å°æ‡‰ç”¨æ€§èƒ½çš„å½±éŸ¿

**æ¸¬è©¦å ´æ™¯**:

```java
// å ´æ™¯ 1: åŸºæº–æ€§èƒ½æ¸¬è©¦
@Test
void shouldMeasureObservabilityOverhead() {
    // Given: ç¦ç”¨å¯è§€æ¸¬æ€§
    disableObservability();
    
    // When: åŸ·è¡ŒåŸºæº–æ¸¬è©¦
    long baselineLatency = measureAverageLatency(1000);
    double baselineThroughput = measureThroughput(60);
    
    // Given: å•Ÿç”¨å¯è§€æ¸¬æ€§
    enableObservability();
    
    // When: åŸ·è¡Œç›¸åŒæ¸¬è©¦
    long observabilityLatency = measureAverageLatency(1000);
    double observabilityThroughput = measureThroughput(60);
    
    // Then: é©—è­‰æ€§èƒ½å½±éŸ¿åœ¨å¯æ¥å—ç¯„åœå…§
    double latencyOverhead = (observabilityLatency - baselineLatency) / (double) baselineLatency * 100;
    double throughputImpact = (baselineThroughput - observabilityThroughput) / baselineThroughput * 100;
    
    assertThat(latencyOverhead).isLessThan(5.0); // < 5% å»¶é²å¢åŠ 
    assertThat(throughputImpact).isLessThan(3.0); // < 3% ååé‡ä¸‹é™
}

// å ´æ™¯ 2: é«˜è² è¼‰ä¸‹çš„ç©©å®šæ€§æ¸¬è©¦
@Test
void shouldMaintainStabilityUnderHighLoad() {
    // Given: é…ç½®é«˜è² è¼‰æ¸¬è©¦
    int concurrentUsers = 100;
    Duration testDuration = Duration.ofMinutes(10);
    
    // When: åŸ·è¡Œè² è¼‰æ¸¬è©¦
    LoadTestResult result = executeLoadTest(concurrentUsers, testDuration);
    
    // Then: é©—è­‰ç³»çµ±ç©©å®šæ€§
    assertThat(result.getErrorRate()).isLessThan(0.1); // < 0.1% éŒ¯èª¤ç‡
    assertThat(result.getP95Latency()).isLessThan(Duration.ofSeconds(2)); // P95 < 2s
    assertThat(result.getMemoryLeaks()).isEmpty(); // ç„¡è¨˜æ†¶é«”æ´©æ¼
    
    // é©—è­‰å¯è§€æ¸¬æ€§æ•¸æ“šå®Œæ•´æ€§
    assertThat(getMetricsCompleteness()).isGreaterThan(0.99); // > 99% æ•¸æ“šå®Œæ•´æ€§
    assertThat(getTraceCompleteness()).isGreaterThan(0.95); // > 95% è¿½è¹¤å®Œæ•´æ€§
}
```

#### 3.2 æ¡æ¨£ç­–ç•¥æ¸¬è©¦

**æ¸¬è©¦ç›®æ¨™**: é©—è­‰è¿½è¹¤æ¡æ¨£ç­–ç•¥çš„æœ‰æ•ˆæ€§

**æ¸¬è©¦å ´æ™¯**:

```java
// å ´æ™¯ 1: æ¡æ¨£ç‡é©—è­‰æ¸¬è©¦
@Test
void shouldRespectSamplingConfiguration() {
    // Given: è¨­ç½® 10% æ¡æ¨£ç‡
    setSamplingRate(0.1);
    
    // When: ç”Ÿæˆå¤§é‡è«‹æ±‚
    int totalRequests = 10000;
    for (int i = 0; i < totalRequests; i++) {
        makeRequest("/api/test");
    }
    
    // Then: é©—è­‰æ¡æ¨£ç‡
    await().atMost(2, MINUTES).untilAsserted(() -> {
        long sampledTraces = countSampledTraces();
        double actualSamplingRate = sampledTraces / (double) totalRequests;
        
        assertThat(actualSamplingRate)
            .isBetween(0.08, 0.12); // å…è¨± Â±2% èª¤å·®
    });
}

// å ´æ™¯ 2: æ™ºèƒ½æ¡æ¨£æ¸¬è©¦
@Test
void shouldApplyIntelligentSampling() {
    // Given: é…ç½®æ™ºèƒ½æ¡æ¨£ (éŒ¯èª¤è«‹æ±‚ 100% æ¡æ¨£ï¼Œæ­£å¸¸è«‹æ±‚ 1% æ¡æ¨£)
    configureIntelligentSampling();
    
    // When: ç”Ÿæˆæ··åˆè«‹æ±‚
    generateNormalRequests(1000);
    generateErrorRequests(10);
    
    // Then: é©—è­‰æ¡æ¨£ç­–ç•¥
    await().atMost(1, MINUTES).untilAsserted(() -> {
        assertThat(getErrorTraceSamplingRate()).isEqualTo(1.0); // 100% éŒ¯èª¤æ¡æ¨£
        assertThat(getNormalTraceSamplingRate()).isBetween(0.005, 0.015); // ~1% æ­£å¸¸æ¡æ¨£
    });
}
```

### ğŸ”’ 4. å®‰å…¨èˆ‡åˆè¦æ€§æ¸¬è©¦

#### 4.1 æ•æ„Ÿæ•¸æ“šé®ç½©æ¸¬è©¦

**æ¸¬è©¦ç›®æ¨™**: é©—è­‰æ•æ„Ÿä¿¡æ¯åœ¨æ—¥èªŒå’Œè¿½è¹¤ä¸­æ­£ç¢ºé®ç½©

**æ¸¬è©¦å ´æ™¯**:

```java
// å ´æ™¯ 1: PII æ•¸æ“šé®ç½©æ¸¬è©¦
@Test
void shouldMaskPiiDataInLogs() {
    // Given: åŒ…å« PII çš„è«‹æ±‚
    CreateUserRequest request = CreateUserRequest.builder()
        .email("user@example.com")
        .phone("0912345678")
        .creditCard("4111111111111111")
        .ssn("123-45-6789")
        .build();
    
    // When: è™•ç†è«‹æ±‚
    userService.createUser(request);
    
    // Then: é©—è­‰æ—¥èªŒä¸­ PII è¢«é®ç½©
    List<LogEntry> logs = getRecentLogEntries();
    assertThat(logs).allMatch(log -> {
        String content = log.getMessage();
        return !content.contains("user@example.com") &&
               !content.contains("0912345678") &&
               !content.contains("4111111111111111") &&
               !content.contains("123-45-6789") &&
               content.contains("***@***.com") && // é®ç½©å¾Œçš„æ ¼å¼
               content.contains("091****678");
    });
}

// å ´æ™¯ 2: è¿½è¹¤æ•¸æ“šå®‰å…¨æ¸¬è©¦
@Test
void shouldNotExposeSecretsInTraces() {
    // Given: åŒ…å«æ•æ„Ÿé…ç½®çš„æ“ä½œ
    String apiKey = "secret-api-key-12345";
    String password = "super-secret-password";
    
    // When: åŸ·è¡Œéœ€è¦èªè­‰çš„æ“ä½œ
    authenticatedService.performOperation(apiKey, password);
    
    // Then: é©—è­‰è¿½è¹¤æ•¸æ“šä¸åŒ…å«æ•æ„Ÿä¿¡æ¯
    await().atMost(30, SECONDS).untilAsserted(() -> {
        List<Span> spans = getRecentSpans();
        assertThat(spans).allMatch(span -> {
            Map<String, String> tags = span.getTags();
            return !tags.values().stream().anyMatch(value -> 
                value.contains(apiKey) || value.contains(password));
        });
    });
}
```

#### 4.2 å¯©è¨ˆæ—¥èªŒæ¸¬è©¦

**æ¸¬è©¦ç›®æ¨™**: é©—è­‰é—œéµæ“ä½œçš„å¯©è¨ˆæ—¥èªŒè¨˜éŒ„

**æ¸¬è©¦å ´æ™¯**:

```java
// å ´æ™¯ 1: ç”¨æˆ¶æ“ä½œå¯©è¨ˆæ¸¬è©¦
@Test
void shouldLogUserOperationsForAudit() {
    // Given: ç”¨æˆ¶åŸ·è¡Œé—œéµæ“ä½œ
    String userId = "user-123";
    String operation = "DELETE_ORDER";
    String orderId = "order-456";
    
    // When: åŸ·è¡Œåˆªé™¤æ“ä½œ
    orderService.deleteOrder(orderId, userId);
    
    // Then: é©—è­‰å¯©è¨ˆæ—¥èªŒ
    await().atMost(10, SECONDS).untilAsserted(() -> {
        List<AuditLogEntry> auditLogs = getAuditLogs();
        assertThat(auditLogs).anyMatch(entry ->
            entry.getUserId().equals(userId) &&
            entry.getOperation().equals(operation) &&
            entry.getResourceId().equals(orderId) &&
            entry.getTimestamp() != null &&
            entry.getIpAddress() != null
        );
    });
}
```

### ğŸ’° 5. æˆæœ¬å„ªåŒ–æ¸¬è©¦

#### 5.1 è³‡æºä½¿ç”¨ç›£æ§æ¸¬è©¦

**æ¸¬è©¦ç›®æ¨™**: é©—è­‰å¯è§€æ¸¬æ€§è³‡æºä½¿ç”¨ç›£æ§å’Œå„ªåŒ–

**æ¸¬è©¦å ´æ™¯**:

```java
// å ´æ™¯ 1: CloudWatch æˆæœ¬ç›£æ§æ¸¬è©¦
@Test
void shouldMonitorCloudWatchCosts() {
    // Given: é‹è¡Œä¸€æ®µæ™‚é–“æ”¶é›†æ•¸æ“š
    Duration monitoringPeriod = Duration.ofHours(1);
    runApplicationUnderLoad(monitoringPeriod);
    
    // When: æŸ¥è©¢æˆæœ¬æŒ‡æ¨™
    CloudWatchCostMetrics costs = cloudWatchCostService.getCostMetrics(monitoringPeriod);
    
    // Then: é©—è­‰æˆæœ¬åœ¨é æœŸç¯„åœå…§
    assertThat(costs.getLogIngestionCost()).isLessThan(10.0); // < $10/hour
    assertThat(costs.getMetricsCost()).isLessThan(5.0); // < $5/hour
    assertThat(costs.getTracingCost()).isLessThan(15.0); // < $15/hour
    
    // é©—è­‰æˆæœ¬å‘Šè­¦é…ç½®
    assertThat(costs.hasAlertConfigured()).isTrue();
    assertThat(costs.getAlertThreshold()).isLessThan(50.0); // < $50/hour å‘Šè­¦
}

// å ´æ™¯ 2: æ•¸æ“šä¿ç•™ç­–ç•¥æ¸¬è©¦
@Test
void shouldApplyDataRetentionPolicies() {
    // Given: é…ç½®æ•¸æ“šä¿ç•™ç­–ç•¥
    configureRetentionPolicies(
        logs: Duration.ofDays(30),
        metrics: Duration.ofDays(90),
        traces: Duration.ofDays(7)
    );
    
    // When: ç­‰å¾…ä¿ç•™ç­–ç•¥ç”Ÿæ•ˆ
    waitForRetentionPolicyApplication();
    
    // Then: é©—è­‰èˆŠæ•¸æ“šè¢«æ¸…ç†
    assertThat(getLogDataAge()).isLessThanOrEqualTo(Duration.ofDays(30));
    assertThat(getMetricDataAge()).isLessThanOrEqualTo(Duration.ofDays(90));
    assertThat(getTraceDataAge()).isLessThanOrEqualTo(Duration.ofDays(7));
}
```

### ğŸŒ 6. å¤šç’°å¢ƒèˆ‡ç½é›£æ¢å¾©æ¸¬è©¦

#### 6.1 å¤šå€åŸŸéƒ¨ç½²æ¸¬è©¦

**æ¸¬è©¦ç›®æ¨™**: é©—è­‰è·¨å€åŸŸå¯è§€æ¸¬æ€§æ•¸æ“šåŒæ­¥å’Œæ•…éšœè½‰ç§»

**æ¸¬è©¦å ´æ™¯**:

```java
// å ´æ™¯ 1: è·¨å€åŸŸæ•¸æ“šåŒæ­¥æ¸¬è©¦
@Test
void shouldSynchronizeObservabilityDataAcrossRegions() {
    // Given: å¤šå€åŸŸéƒ¨ç½²
    List<String> regions = Arrays.asList("us-east-1", "us-west-2", "eu-west-1");
    
    // When: åœ¨ä¸»å€åŸŸç”Ÿæˆæ•¸æ“š
    String correlationId = generateDataInPrimaryRegion();
    
    // Then: é©—è­‰æ•¸æ“šåœ¨æ‰€æœ‰å€åŸŸå¯è¦‹
    await().atMost(5, MINUTES).untilAsserted(() -> {
        for (String region : regions) {
            assertThat(isDataAvailableInRegion(correlationId, region)).isTrue();
        }
    });
}

// å ´æ™¯ 2: å€åŸŸæ•…éšœè½‰ç§»æ¸¬è©¦
@Test
void shouldFailoverObservabilityServicesGracefully() {
    // Given: ä¸»å€åŸŸæ­£å¸¸é‹è¡Œ
    String primaryRegion = "us-east-1";
    String secondaryRegion = "us-west-2";
    
    // When: æ¨¡æ“¬ä¸»å€åŸŸæ•…éšœ
    simulateRegionFailure(primaryRegion);
    
    // Then: é©—è­‰æ•…éšœè½‰ç§»
    await().atMost(2, MINUTES).untilAsserted(() -> {
        assertThat(isObservabilityServiceActive(secondaryRegion)).isTrue();
        assertThat(getActiveRegion()).isEqualTo(secondaryRegion);
    });
    
    // é©—è­‰æ•¸æ“šå®Œæ•´æ€§
    assertThat(getDataLossDuringFailover()).isLessThan(0.01); // < 1% æ•¸æ“šä¸Ÿå¤±
}
```

#### 6.2 ç½é›£æ¢å¾©æ¸¬è©¦

**æ¸¬è©¦ç›®æ¨™**: é©—è­‰å¯è§€æ¸¬æ€§ç³»çµ±çš„ç½é›£æ¢å¾©èƒ½åŠ›

**æ¸¬è©¦å ´æ™¯**:

```java
// å ´æ™¯ 1: å®Œæ•´ç½é›£æ¢å¾©æ¸¬è©¦
@Test
void shouldRecoverFromCompleteSystemFailure() {
    // Given: ç³»çµ±æ­£å¸¸é‹è¡Œ
    generateBaselineData();
    
    // When: æ¨¡æ“¬å®Œæ•´ç³»çµ±æ•…éšœ
    simulateCompleteSystemFailure();
    
    // åŸ·è¡Œç½é›£æ¢å¾©ç¨‹åº
    executeDisasterRecoveryProcedure();
    
    // Then: é©—è­‰ç³»çµ±æ¢å¾©
    await().atMost(30, MINUTES).untilAsserted(() -> {
        assertThat(isSystemFullyRecovered()).isTrue();
        assertThat(getDataIntegrityScore()).isGreaterThan(0.95); // > 95% æ•¸æ“šå®Œæ•´æ€§
        assertThat(getRecoveryTimeObjective()).isLessThan(Duration.ofMinutes(30)); // RTO < 30min
    });
}

// å ´æ™¯ 2: éƒ¨åˆ†æœå‹™æ•…éšœæ¢å¾©æ¸¬è©¦
@Test
void shouldRecoverFromPartialServiceFailure() {
    // Given: æ¨¡æ“¬éƒ¨åˆ†æœå‹™æ•…éšœ
    simulateServiceFailure("tracing-service");
    
    // When: ç³»çµ±ç¹¼çºŒé‹è¡Œ
    continueOperationsWithDegradedService();
    
    // Then: é©—è­‰å„ªé›…é™ç´š
    assertThat(isLoggingServiceActive()).isTrue();
    assertThat(isMetricsServiceActive()).isTrue();
    assertThat(isTracingServiceActive()).isFalse();
    
    // é©—è­‰æœå‹™æ¢å¾©
    restoreService("tracing-service");
    await().atMost(5, MINUTES).untilAsserted(() -> {
        assertThat(isTracingServiceActive()).isTrue();
        assertThat(getServiceHealthScore()).isEqualTo(1.0); // 100% å¥åº·
    });
}
```

### ğŸ”„ 7. CI/CD é›†æˆæ¸¬è©¦

#### 7.1 éƒ¨ç½²ç®¡é“å¯è§€æ¸¬æ€§æ¸¬è©¦

**æ¸¬è©¦ç›®æ¨™**: é©—è­‰ CI/CD ç®¡é“ä¸­çš„å¯è§€æ¸¬æ€§é›†æˆ

**æ¸¬è©¦å ´æ™¯**:

```java
// å ´æ™¯ 1: éƒ¨ç½²æŒ‡æ¨™æ¸¬è©¦
@Test
void shouldCollectDeploymentMetrics() {
    // Given: è§¸ç™¼éƒ¨ç½²
    String deploymentId = triggerDeployment();
    
    // When: éƒ¨ç½²åŸ·è¡Œ
    waitForDeploymentCompletion(deploymentId);
    
    // Then: é©—è­‰éƒ¨ç½²æŒ‡æ¨™
    DeploymentMetrics metrics = getDeploymentMetrics(deploymentId);
    assertThat(metrics.getDeploymentDuration()).isLessThan(Duration.ofMinutes(15));
    assertThat(metrics.getSuccessRate()).isEqualTo(1.0);
    assertThat(metrics.getRollbackCount()).isEqualTo(0);
}

// å ´æ™¯ 2: å“è³ªé–€æª»æ¸¬è©¦
@Test
void shouldEnforceQualityGatesInPipeline() {
    // Given: é…ç½®å“è³ªé–€æª»
    configureQualityGates(
        errorRate: 0.01,        // < 1% éŒ¯èª¤ç‡
        responseTime: Duration.ofSeconds(2), // < 2s éŸ¿æ‡‰æ™‚é–“
        availability: 0.999     // > 99.9% å¯ç”¨æ€§
    );
    
    // When: åŸ·è¡Œéƒ¨ç½²é©—è­‰
    QualityGateResult result = executeQualityGateValidation();
    
    // Then: é©—è­‰å“è³ªé–€æª»
    assertThat(result.getErrorRate()).isLessThan(0.01);
    assertThat(result.getAverageResponseTime()).isLessThan(Duration.ofSeconds(2));
    assertThat(result.getAvailability()).isGreaterThan(0.999);
    assertThat(result.isPassed()).isTrue();
}
```

## æ¸¬è©¦ç’°å¢ƒé…ç½®

### ğŸ› ï¸ ç”Ÿç”¢ç’°å¢ƒé…ç½®

#### AWS æœå‹™é…ç½®

```yaml
# CloudWatch é…ç½®
cloudwatch:
  region: us-east-1
  log-groups:
    - name: /aws/lambda/genai-demo
      retention-days: 30
    - name: /aws/ecs/genai-demo
      retention-days: 30
  metrics:
    namespace: GenAIDemo/Production
    dimensions:
      Environment: production
      Service: genai-demo
  alarms:
    - name: HighErrorRate
      threshold: 0.05
      comparison: GreaterThanThreshold
    - name: HighLatency
      threshold: 2000
      comparison: GreaterThanThreshold

# X-Ray é…ç½®
xray:
  tracing-config:
    sampling-rate: 0.1
    reservoir-size: 1
  service-map:
    enabled: true
  annotations:
    - service
    - environment
    - version

# Prometheus é…ç½® (å¯é¸)
prometheus:
  scrape-configs:
    - job_name: genai-demo
      static_configs:
        - targets: ['localhost:8080']
      metrics_path: /actuator/prometheus
      scrape_interval: 30s
```

#### Spring Boot é…ç½®

```yaml
# application-production.yml
management:
  endpoints:
    web:
      exposure:
        include: health,info,metrics,prometheus
  endpoint:
    health:
      show-details: always
      show-components: always
      probes:
        enabled: true
    metrics:
      enabled: true
    prometheus:
      enabled: true
  metrics:
    export:
      cloudwatch:
        enabled: true
        namespace: GenAIDemo/Production
        batch-size: 20
      prometheus:
        enabled: true
    tags:
      environment: production
      service: genai-demo
      version: ${app.version:unknown}

# æ—¥èªŒé…ç½®
logging:
  level:
    solid.humank.genaidemo: INFO
    org.springframework.web: WARN
  pattern:
    console: "%d{yyyy-MM-dd HH:mm:ss} [%thread] %-5level [%X{correlationId:-}] %logger{36} - %msg%n"
  appender:
    cloudwatch:
      enabled: true
      log-group: /aws/ecs/genai-demo
      log-stream: ${HOSTNAME:localhost}

# è¿½è¹¤é…ç½®
tracing:
  enabled: true
  sampling:
    probability: 0.1
  zipkin:
    enabled: false
  jaeger:
    enabled: false
  xray:
    enabled: true
```

### ğŸ§ª æ¸¬è©¦æ•¸æ“šæº–å‚™

#### æ¸¬è©¦æ•¸æ“šç”Ÿæˆå™¨

```java
@Component
public class ObservabilityTestDataGenerator {
    
    public void generateBusinessOperations(int count) {
        for (int i = 0; i < count; i++) {
            // ç”Ÿæˆè¨‚å–®
            createTestOrder();
            
            // ç”Ÿæˆæ”¯ä»˜
            processTestPayment();
            
            // ç”Ÿæˆåº«å­˜æ“ä½œ
            updateTestInventory();
            
            // éš¨æ©Ÿå»¶é²
            randomDelay();
        }
    }
    
    public void generateErrorScenarios() {
        // ç”Ÿæˆ 4xx éŒ¯èª¤
        generate4xxErrors();
        
        // ç”Ÿæˆ 5xx éŒ¯èª¤
        generate5xxErrors();
        
        // ç”Ÿæˆè¶…æ™‚éŒ¯èª¤
        generateTimeoutErrors();
        
        // ç”Ÿæˆæ•¸æ“šåº«é€£æ¥éŒ¯èª¤
        generateDatabaseErrors();
    }
    
    public void generateHighLoadScenario(Duration duration) {
        long endTime = System.currentTimeMillis() + duration.toMillis();
        
        while (System.currentTimeMillis() < endTime) {
            CompletableFuture.runAsync(this::generateBusinessOperations);
            Thread.sleep(100); // æ§åˆ¶è² è¼‰
        }
    }
}
```

## æ¸¬è©¦åŸ·è¡Œè¨ˆåŠƒ

### ğŸ“… æ¸¬è©¦éšæ®µè¦åŠƒ

#### éšæ®µ 1: åŸºç¤é©—è­‰ (1-2 å¤©)

**ç›®æ¨™**: é©—è­‰åŸºæœ¬å¯è§€æ¸¬æ€§åŠŸèƒ½

**æ¸¬è©¦å…§å®¹**:

- âœ… æ‡‰ç”¨å•Ÿå‹•å’Œå¥åº·æª¢æŸ¥
- âœ… åŸºæœ¬æ—¥èªŒè¨˜éŒ„å’Œæ ¼å¼åŒ–
- âœ… åŸºæœ¬æŒ‡æ¨™æ”¶é›†
- âœ… ç°¡å–®è¿½è¹¤åŠŸèƒ½

**æˆåŠŸæ¨™æº–**:

- æ‰€æœ‰å¥åº·æª¢æŸ¥ç«¯é»æ­£å¸¸éŸ¿æ‡‰
- æ—¥èªŒæ ¼å¼ç¬¦åˆ JSON æ¨™æº–
- åŸºæœ¬æŒ‡æ¨™åœ¨ CloudWatch ä¸­å¯è¦‹
- å–®ä¸€æœå‹™è¿½è¹¤æ­£å¸¸å·¥ä½œ

#### éšæ®µ 2: é›†æˆé©—è­‰ (3-5 å¤©)

**ç›®æ¨™**: é©—è­‰è·¨æœå‹™å¯è§€æ¸¬æ€§é›†æˆ

**æ¸¬è©¦å…§å®¹**:

- âœ… è·¨æœå‹™è¿½è¹¤
- âœ… é—œè¯ ID å‚³æ’­
- âœ… æ¥­å‹™æŒ‡æ¨™æº–ç¢ºæ€§
- âœ… éŒ¯èª¤è™•ç†å’Œç›£æ§

**æˆåŠŸæ¨™æº–**:

- è·¨æœå‹™è¿½è¹¤å®Œæ•´æ€§ > 95%
- é—œè¯ ID å‚³æ’­æˆåŠŸç‡ > 99%
- æ¥­å‹™æŒ‡æ¨™èˆ‡å¯¦éš›æ“ä½œä¸€è‡´
- éŒ¯èª¤ç›£æ§å’Œå‘Šè­¦æ­£å¸¸

#### éšæ®µ 3: æ€§èƒ½é©—è­‰ (2-3 å¤©)

**ç›®æ¨™**: é©—è­‰å¯è§€æ¸¬æ€§ç³»çµ±æ€§èƒ½å½±éŸ¿

**æ¸¬è©¦å…§å®¹**:

- âœ… æ€§èƒ½åŸºæº–æ¸¬è©¦
- âœ… è² è¼‰æ¸¬è©¦
- âœ… æ¡æ¨£ç­–ç•¥é©—è­‰
- âœ… è³‡æºä½¿ç”¨ç›£æ§

**æˆåŠŸæ¨™æº–**:

- å¯è§€æ¸¬æ€§é–‹éŠ· < 5%
- é«˜è² è¼‰ä¸‹ç³»çµ±ç©©å®š
- æ¡æ¨£ç­–ç•¥æœ‰æ•ˆ
- è³‡æºä½¿ç”¨åœ¨é æœŸç¯„åœå…§

#### éšæ®µ 4: å®‰å…¨èˆ‡åˆè¦é©—è­‰ (2-3 å¤©)

**ç›®æ¨™**: é©—è­‰å®‰å…¨å’Œåˆè¦è¦æ±‚

**æ¸¬è©¦å…§å®¹**:

- âœ… æ•æ„Ÿæ•¸æ“šé®ç½©
- âœ… å¯©è¨ˆæ—¥èªŒå®Œæ•´æ€§
- âœ… æ•¸æ“šä¿ç•™ç­–ç•¥
- âœ… è¨ªå•æ§åˆ¶

**æˆåŠŸæ¨™æº–**:

- PII æ•¸æ“š 100% é®ç½©
- å¯©è¨ˆæ—¥èªŒå®Œæ•´è¨˜éŒ„
- æ•¸æ“šä¿ç•™ç­–ç•¥ç”Ÿæ•ˆ
- è¨ªå•æ§åˆ¶æ­£ç¢ºé…ç½®

#### éšæ®µ 5: ç½é›£æ¢å¾©é©—è­‰ (3-5 å¤©)

**ç›®æ¨™**: é©—è­‰ç½é›£æ¢å¾©èƒ½åŠ›

**æ¸¬è©¦å…§å®¹**:

- âœ… å¤šå€åŸŸæ•…éšœè½‰ç§»
- âœ… æ•¸æ“šå‚™ä»½å’Œæ¢å¾©
- âœ… æœå‹™é™ç´šè™•ç†
- âœ… å®Œæ•´ç½é›£æ¢å¾©

**æˆåŠŸæ¨™æº–**:

- RTO < 30 åˆ†é˜
- RPO < 5 åˆ†é˜
- æ•¸æ“šå®Œæ•´æ€§ > 95%
- æœå‹™é™ç´šæ­£å¸¸

### ğŸ¯ æ¸¬è©¦åŸ·è¡Œæª¢æŸ¥æ¸…å–®

#### æ¸¬è©¦å‰æº–å‚™

- [ ] **ç’°å¢ƒæº–å‚™**
  - [ ] AWS å¸³æˆ¶å’Œæ¬Šé™é…ç½®
  - [ ] CloudWatchã€X-Ray æœå‹™å•Ÿç”¨
  - [ ] æ¸¬è©¦æ•¸æ“šæº–å‚™
  - [ ] ç›£æ§å„€è¡¨æ¿è¨­ç½®

- [ ] **å·¥å…·æº–å‚™**
  - [ ] è² è¼‰æ¸¬è©¦å·¥å…· (JMeter/Gatling)
  - [ ] ç›£æ§å·¥å…· (Grafana/CloudWatch Dashboard)
  - [ ] æ—¥èªŒåˆ†æå·¥å…· (CloudWatch Insights)
  - [ ] è¿½è¹¤åˆ†æå·¥å…· (X-Ray Console)

- [ ] **åœ˜éšŠæº–å‚™**
  - [ ] æ¸¬è©¦åœ˜éšŠåŸ¹è¨“
  - [ ] è§’è‰²å’Œè²¬ä»»åˆ†é…
  - [ ] æºé€šæ¸ é“å»ºç«‹
  - [ ] ç·Šæ€¥è¯çµ¡æ–¹å¼

#### æ¸¬è©¦åŸ·è¡Œ

- [ ] **æ¯æ—¥æª¢æŸ¥**
  - [ ] æ¸¬è©¦ç’°å¢ƒå¥åº·ç‹€æ…‹
  - [ ] æ¸¬è©¦æ•¸æ“šå®Œæ•´æ€§
  - [ ] æ¸¬è©¦çµæœè¨˜éŒ„
  - [ ] å•é¡Œè¿½è¹¤å’Œè§£æ±º

- [ ] **æ¯é€±å›é¡§**
  - [ ] æ¸¬è©¦é€²åº¦è©•ä¼°
  - [ ] é¢¨éšªè­˜åˆ¥å’Œç·©è§£
  - [ ] æ¸¬è©¦è¨ˆåŠƒèª¿æ•´
  - [ ] åˆ©å®³é—œä¿‚äººæºé€š

#### æ¸¬è©¦å¾Œæ¸…ç†

- [ ] **æ•¸æ“šæ¸…ç†**
  - [ ] æ¸¬è©¦æ•¸æ“šæ¸…é™¤
  - [ ] è‡¨æ™‚è³‡æºé‡‹æ”¾
  - [ ] æˆæœ¬åˆ†æå’Œå„ªåŒ–
  - [ ] ç’°å¢ƒé‡ç½®

- [ ] **æ–‡æª”æ•´ç†**
  - [ ] æ¸¬è©¦å ±å‘Šç·¨å¯«
  - [ ] å•é¡Œå’Œè§£æ±ºæ–¹æ¡ˆè¨˜éŒ„
  - [ ] æœ€ä½³å¯¦è¸ç¸½çµ
  - [ ] çŸ¥è­˜è½‰ç§»

## é©—æ”¶æ¨™æº–

### ğŸ¯ åŠŸèƒ½æ€§é©—æ”¶æ¨™æº–

#### æ—¥èªŒç³»çµ±

- âœ… **çµæ§‹åŒ–æ—¥èªŒ**: 100% çš„æ—¥èªŒæ¢ç›®ç¬¦åˆ JSON æ ¼å¼
- âœ… **MDC å‚³æ’­**: é—œè¯ ID åœ¨æ•´å€‹è«‹æ±‚ç”Ÿå‘½é€±æœŸä¸­ä¿æŒä¸€è‡´
- âœ… **æ—¥èªŒç­‰ç´š**: æ”¯æ´å‹•æ…‹èª¿æ•´æ—¥èªŒç­‰ç´š
- âœ… **æ•æ„Ÿæ•¸æ“š**: PII å’Œæ©Ÿå¯†ä¿¡æ¯ 100% é®ç½©

#### æŒ‡æ¨™ç³»çµ±

- âœ… **æ¥­å‹™æŒ‡æ¨™**: æº–ç¢ºåæ˜ å¯¦éš›æ¥­å‹™æ“ä½œ
- âœ… **ç³»çµ±æŒ‡æ¨™**: æ¶µè“‹ JVMã€HTTPã€æ•¸æ“šåº«ç­‰é—œéµçµ„ä»¶
- âœ… **è‡ªå®šç¾©æŒ‡æ¨™**: æ”¯æ´æ¥­å‹™ç‰¹å®šæŒ‡æ¨™å®šç¾©
- âœ… **æŒ‡æ¨™æ¨™ç±¤**: æ­£ç¢ºè¨­ç½®ç¶­åº¦æ¨™ç±¤

#### è¿½è¹¤ç³»çµ±

- âœ… **è·¨æœå‹™è¿½è¹¤**: å®Œæ•´æ€§ > 95%
- âœ… **è¿½è¹¤ä¸Šä¸‹æ–‡**: æ­£ç¢ºå‚³æ’­è¿½è¹¤ä¸Šä¸‹æ–‡
- âœ… **æ¡æ¨£ç­–ç•¥**: æ¡æ¨£ç‡æ§åˆ¶åœ¨é…ç½®ç¯„åœå…§
- âœ… **è¿½è¹¤å¯è¦–åŒ–**: åœ¨ X-Ray/Jaeger ä¸­æ­£ç¢ºé¡¯ç¤º

#### å¥åº·æª¢æŸ¥

- âœ… **éŸ¿æ‡‰æ™‚é–“**: å¥åº·æª¢æŸ¥ < 5sï¼Œæ¢é‡ < 3s
- âœ… **ä¾è³´æª¢æŸ¥**: æ­£ç¢ºæª¢æ¸¬ä¾è³´æœå‹™ç‹€æ…‹
- âœ… **æ•…éšœè™•ç†**: ä¾è³´æ•…éšœæ™‚æ­£ç¢ºå ±å‘Šç‹€æ…‹
- âœ… **Kubernetes é›†æˆ**: æ¢é‡èˆ‡ K8s æ­£ç¢ºé›†æˆ

### ğŸ“Š æ€§èƒ½é©—æ”¶æ¨™æº–

#### ç³»çµ±æ€§èƒ½

- âœ… **å»¶é²å½±éŸ¿**: å¯è§€æ¸¬æ€§é–‹éŠ· < 5%
- âœ… **ååé‡å½±éŸ¿**: ååé‡ä¸‹é™ < 3%
- âœ… **è¨˜æ†¶é«”ä½¿ç”¨**: è¨˜æ†¶é«”å¢åŠ  < 10%
- âœ… **CPU ä½¿ç”¨**: CPU å¢åŠ  < 5%

#### å¯æ“´å±•æ€§

- âœ… **é«˜è² è¼‰ç©©å®šæ€§**: 100 ä½µç™¼ç”¨æˆ¶ä¸‹ç©©å®šé‹è¡Œ
- âœ… **æ•¸æ“šå®Œæ•´æ€§**: é«˜è² è¼‰ä¸‹æ•¸æ“šå®Œæ•´æ€§ > 99%
- âœ… **éŒ¯èª¤ç‡**: ç³»çµ±éŒ¯èª¤ç‡ < 0.1%
- âœ… **æ¢å¾©æ™‚é–“**: è² è¼‰å¾Œæ¢å¾©æ™‚é–“ < 5 åˆ†é˜

### ğŸ”’ å®‰å…¨é©—æ”¶æ¨™æº–

#### æ•¸æ“šä¿è­·

- âœ… **PII é®ç½©**: å€‹äººè­˜åˆ¥ä¿¡æ¯ 100% é®ç½©
- âœ… **æ©Ÿå¯†ä¿¡æ¯**: API é‡‘é‘°ã€å¯†ç¢¼ç­‰ä¸å‡ºç¾åœ¨æ—¥èªŒä¸­
- âœ… **æ•¸æ“šå‚³è¼¸**: æ‰€æœ‰æ•¸æ“šå‚³è¼¸ä½¿ç”¨ TLS åŠ å¯†
- âœ… **è¨ªå•æ§åˆ¶**: åŸºæ–¼è§’è‰²çš„è¨ªå•æ§åˆ¶æ­£ç¢ºé…ç½®

#### åˆè¦æ€§

- âœ… **å¯©è¨ˆæ—¥èªŒ**: é—œéµæ“ä½œ 100% è¨˜éŒ„
- âœ… **æ•¸æ“šä¿ç•™**: æŒ‰æ”¿ç­–è‡ªå‹•æ¸…ç†éæœŸæ•¸æ“š
- âœ… **æ³•è¦éµå¾ª**: ç¬¦åˆ GDPRã€SOX ç­‰æ³•è¦è¦æ±‚
- âœ… **æ•¸æ“šä¸»æ¬Š**: æ•¸æ“šå­˜å„²ç¬¦åˆåœ°å€æ³•è¦

### ğŸ’° æˆæœ¬é©—æ”¶æ¨™æº–

#### æˆæœ¬æ§åˆ¶

- âœ… **CloudWatch æˆæœ¬**: < $100/æœˆ (åŸºæ–¼é æœŸè² è¼‰)
- âœ… **X-Ray æˆæœ¬**: < $50/æœˆ
- âœ… **å­˜å„²æˆæœ¬**: < $30/æœˆ
- âœ… **ç¸½æˆæœ¬**: å¯è§€æ¸¬æ€§ç¸½æˆæœ¬ < é‹ç‡Ÿæˆæœ¬çš„ 5%

#### æˆæœ¬å„ªåŒ–

- âœ… **æ¡æ¨£ç­–ç•¥**: æœ‰æ•ˆé™ä½è¿½è¹¤æˆæœ¬
- âœ… **æ•¸æ“šä¿ç•™**: è‡ªå‹•æ¸…ç†é™ä½å­˜å„²æˆæœ¬
- âœ… **å‘Šè­¦é…ç½®**: æˆæœ¬ç•°å¸¸åŠæ™‚å‘Šè­¦
- âœ… **ä½¿ç”¨ç›£æ§**: å®šæœŸå¯©æŸ¥å’Œå„ªåŒ–ä½¿ç”¨

## æ•…éšœæ’é™¤

### ğŸš¨ å¸¸è¦‹å•é¡Œèˆ‡è§£æ±ºæ–¹æ¡ˆ

#### æ—¥èªŒå•é¡Œ

**å•é¡Œ**: æ—¥èªŒæ ¼å¼ä¸æ­£ç¢º

```
è§£æ±ºæ–¹æ¡ˆ:
1. æª¢æŸ¥ logback-spring.xml é…ç½®
2. é©—è­‰ JSON ç·¨ç¢¼å™¨è¨­ç½®
3. ç¢ºèª MDC é…ç½®æ­£ç¢º
4. æ¸¬è©¦æ—¥èªŒè¼¸å‡ºæ ¼å¼
```

**å•é¡Œ**: é—œè¯ ID ä¸Ÿå¤±

```
è§£æ±ºæ–¹æ¡ˆ:
1. æª¢æŸ¥ MDC éæ¿¾å™¨é…ç½®
2. é©—è­‰ç•°æ­¥è™•ç†ä¸­çš„ä¸Šä¸‹æ–‡å‚³æ’­
3. ç¢ºèªè·¨æœå‹™èª¿ç”¨ä¸­çš„æ¨™é ­å‚³é
4. æª¢æŸ¥ç·šç¨‹æ± é…ç½®
```

#### æŒ‡æ¨™å•é¡Œ

**å•é¡Œ**: æŒ‡æ¨™æ•¸æ“šç¼ºå¤±

```
è§£æ±ºæ–¹æ¡ˆ:
1. æª¢æŸ¥ Micrometer é…ç½®
2. é©—è­‰ CloudWatch æ¬Šé™
3. ç¢ºèªæŒ‡æ¨™è¨»å†Šæ­£ç¢º
4. æª¢æŸ¥ç¶²è·¯é€£æ¥
```

**å•é¡Œ**: æŒ‡æ¨™æ•¸æ“šä¸æº–ç¢º

```
è§£æ±ºæ–¹æ¡ˆ:
1. é©—è­‰æŒ‡æ¨™è¨ˆç®—é‚è¼¯
2. æª¢æŸ¥æ¨™ç±¤è¨­ç½®
3. ç¢ºèªæ™‚é–“åŒæ­¥
4. æª¢æŸ¥æ¡æ¨£é…ç½®
```

#### è¿½è¹¤å•é¡Œ

**å•é¡Œ**: è¿½è¹¤æ•¸æ“šä¸å®Œæ•´

```
è§£æ±ºæ–¹æ¡ˆ:
1. æª¢æŸ¥ OpenTelemetry é…ç½®
2. é©—è­‰æ¡æ¨£ç‡è¨­ç½®
3. ç¢ºèª X-Ray æ¬Šé™
4. æª¢æŸ¥ç¶²è·¯é€£æ¥å’Œé˜²ç«ç‰†
```

**å•é¡Œ**: è·¨æœå‹™è¿½è¹¤ä¸­æ–·

```
è§£æ±ºæ–¹æ¡ˆ:
1. æª¢æŸ¥è¿½è¹¤ä¸Šä¸‹æ–‡å‚³æ’­
2. é©—è­‰ HTTP æ¨™é ­é…ç½®
3. ç¢ºèªæœå‹™é–“é€šä¿¡é…ç½®
4. æª¢æŸ¥è¿½è¹¤ ID æ ¼å¼
```

### ğŸ”§ è¨ºæ–·å·¥å…·

#### æ—¥èªŒè¨ºæ–·

```bash
# æª¢æŸ¥æ—¥èªŒæ ¼å¼
curl -s http://localhost:8080/actuator/loggers | jq .

# æ¸¬è©¦ MDC åŠŸèƒ½
curl -H "X-Correlation-ID: test-123" http://localhost:8080/api/test

# æŸ¥çœ‹ CloudWatch æ—¥èªŒ
aws logs describe-log-groups --log-group-name-prefix "/aws/ecs/genai-demo"
```

#### æŒ‡æ¨™è¨ºæ–·

```bash
# æª¢æŸ¥ Prometheus ç«¯é»
curl -s http://localhost:8080/actuator/prometheus | grep genai_demo

# æŸ¥çœ‹ CloudWatch æŒ‡æ¨™
aws cloudwatch list-metrics --namespace "GenAIDemo/Production"

# æ¸¬è©¦è‡ªå®šç¾©æŒ‡æ¨™
curl -X POST http://localhost:8080/api/test/metrics
```

#### è¿½è¹¤è¨ºæ–·

```bash
# æª¢æŸ¥ X-Ray æœå‹™åœ°åœ–
aws xray get-service-graph --start-time 2024-01-01T00:00:00Z --end-time 2024-01-01T23:59:59Z

# æŸ¥çœ‹è¿½è¹¤æ‘˜è¦
aws xray get-trace-summaries --time-range-type TimeRangeByStartTime --start-time 2024-01-01T00:00:00Z --end-time 2024-01-01T01:00:00Z
```

## æœ€ä½³å¯¦è¸

### ğŸ† é–‹ç™¼æœ€ä½³å¯¦è¸

#### æ—¥èªŒæœ€ä½³å¯¦è¸

1. **ä½¿ç”¨çµæ§‹åŒ–æ—¥èªŒ**: å§‹çµ‚ä½¿ç”¨ JSON æ ¼å¼
2. **åˆç†çš„æ—¥èªŒç­‰ç´š**: ç”Ÿç”¢ç’°å¢ƒä½¿ç”¨ INFO ä»¥ä¸Šç­‰ç´š
3. **é¿å…æ•æ„Ÿä¿¡æ¯**: æ°¸é ä¸è¦è¨˜éŒ„å¯†ç¢¼ã€API é‡‘é‘°ç­‰
4. **ä½¿ç”¨ MDC**: ç‚ºæ¯å€‹è«‹æ±‚è¨­ç½®é—œè¯ ID
5. **ç•°å¸¸è™•ç†**: è¨˜éŒ„å®Œæ•´çš„ç•°å¸¸å †ç–Šè¿½è¹¤

#### æŒ‡æ¨™æœ€ä½³å¯¦è¸

1. **æ¥­å‹™æŒ‡æ¨™å„ªå…ˆ**: é—œæ³¨æ¥­å‹™åƒ¹å€¼æŒ‡æ¨™
2. **åˆç†çš„ç¶­åº¦**: é¿å…é«˜åŸºæ•¸æ¨™ç±¤
3. **ä¸€è‡´çš„å‘½å**: ä½¿ç”¨çµ±ä¸€çš„æŒ‡æ¨™å‘½åè¦ç¯„
4. **é©ç•¶çš„é¡å‹**: é¸æ“‡æ­£ç¢ºçš„æŒ‡æ¨™é¡å‹ (Counter, Gauge, Timer)
5. **å®šæœŸæ¸…ç†**: ç§»é™¤ä¸å†ä½¿ç”¨çš„æŒ‡æ¨™

#### è¿½è¹¤æœ€ä½³å¯¦è¸

1. **æ™ºèƒ½æ¡æ¨£**: éŒ¯èª¤è«‹æ±‚ 100% æ¡æ¨£ï¼Œæ­£å¸¸è«‹æ±‚ä½æ¡æ¨£
2. **æœ‰æ„ç¾©çš„ Span**: ç‚ºé‡è¦æ“ä½œå‰µå»º Span
3. **æ­£ç¢ºçš„æ¨™ç±¤**: æ·»åŠ æœ‰åŠ©æ–¼åˆ†æçš„æ¨™ç±¤
4. **ä¸Šä¸‹æ–‡å‚³æ’­**: ç¢ºä¿è·¨æœå‹™ä¸Šä¸‹æ–‡æ­£ç¢ºå‚³æ’­
5. **æ€§èƒ½è€ƒé‡**: é¿å…è¿½è¹¤å°æ€§èƒ½é€ æˆé¡¯è‘—å½±éŸ¿

### ğŸ¯ é‹ç¶­æœ€ä½³å¯¦è¸

#### ç›£æ§ç­–ç•¥

1. **åˆ†å±¤ç›£æ§**: åŸºç¤è¨­æ–½ã€æ‡‰ç”¨ã€æ¥­å‹™ä¸‰å±¤ç›£æ§
2. **ä¸»å‹•å‘Šè­¦**: åŸºæ–¼ SLI/SLO è¨­ç½®å‘Šè­¦
3. **å‘Šè­¦ç–²å‹**: é¿å…éå¤šç„¡æ„ç¾©å‘Šè­¦
4. **æ ¹å› åˆ†æ**: å»ºç«‹å•é¡Œæ ¹å› åˆ†ææµç¨‹
5. **æŒçºŒæ”¹é€²**: å®šæœŸå›é¡§å’Œå„ªåŒ–ç›£æ§ç­–ç•¥

#### æˆæœ¬ç®¡ç†

1. **å®šæœŸå¯©æŸ¥**: æ¯æœˆå¯©æŸ¥å¯è§€æ¸¬æ€§æˆæœ¬
2. **æ¡æ¨£å„ªåŒ–**: æ ¹æ“šåƒ¹å€¼èª¿æ•´æ¡æ¨£ç­–ç•¥
3. **æ•¸æ“šç”Ÿå‘½é€±æœŸ**: å¯¦æ–½è‡ªå‹•æ•¸æ“šæ¸…ç†
4. **è³‡æºæ¨™ç±¤**: ä½¿ç”¨æ¨™ç±¤é€²è¡Œæˆæœ¬åˆ†é…
5. **é ç®—å‘Šè­¦**: è¨­ç½®æˆæœ¬é ç®—å’Œå‘Šè­¦

#### å®‰å…¨ç®¡ç†

1. **æœ€å°æ¬Šé™**: éµå¾ªæœ€å°æ¬Šé™åŸå‰‡
2. **å®šæœŸå¯©è¨ˆ**: å®šæœŸå¯©è¨ˆè¨ªå•æ¬Šé™
3. **æ•¸æ“šåˆ†é¡**: å°å¯è§€æ¸¬æ€§æ•¸æ“šé€²è¡Œåˆ†é¡
4. **åˆè¦æª¢æŸ¥**: å®šæœŸé€²è¡Œåˆè¦æ€§æª¢æŸ¥
5. **äº‹ä»¶éŸ¿æ‡‰**: å»ºç«‹å®‰å…¨äº‹ä»¶éŸ¿æ‡‰æµç¨‹

---

## ğŸ“š åƒè€ƒè³‡æº

### æŠ€è¡“æ–‡æª”

- [Spring Boot Actuator å®˜æ–¹æ–‡æª”](https://docs.spring.io/spring-boot/docs/current/reference/html/actuator.html)
- [Micrometer å®˜æ–¹æ–‡æª”](https://micrometer.io/docs)
- [OpenTelemetry Java æ–‡æª”](https://opentelemetry.io/docs/instrumentation/java/)
- [AWS CloudWatch æ–‡æª”](https://docs.aws.amazon.com/cloudwatch/)
- [AWS X-Ray æ–‡æª”](https://docs.aws.amazon.com/xray/)

### æœ€ä½³å¯¦è¸æŒ‡å—

- [Google SRE Book - Monitoring](https://sre.google/sre-book/monitoring-distributed-systems/)
- [AWS Well-Architected Framework - Observability](https://docs.aws.amazon.com/wellarchitected/latest/framework/ops_observability.html)
- [CNCF Observability Whitepaper](https://github.com/cncf/tag-observability/blob/main/whitepaper.md)

### å·¥å…·å’Œå¹³å°

- [Prometheus](https://prometheus.io/)
- [Grafana](https://grafana.com/)
- [Jaeger](https://www.jaegertracing.io/)
- [ELK Stack](https://www.elastic.co/elastic-stack/)

---

**æ–‡æª”ç‰ˆæœ¬**: 1.0  
**æœ€å¾Œæ›´æ–°**: 2025å¹´9æœˆ  
**ç¶­è­·è€…**: GenAI Demo é–‹ç™¼åœ˜éšŠ  
**å¯©æ ¸è€…**: æ¶æ§‹åœ˜éšŠã€SRE åœ˜éšŠ

---

## ğŸŒŸ æ¥­ç•Œä¸»æµå¯è§€æ¸¬æ€§æ¸¬è©¦å¯¦è¸

### ğŸ“Š **å¯¦éš›æ¥­ç•Œåšæ³•åˆ†æ**

æ‚¨æå‡ºäº†ä¸€å€‹å¾ˆé‡è¦çš„å•é¡Œï¼å¯¦å‹™ä¸Šï¼Œæ¥­ç•Œæ¸¬è©¦å¯è§€æ¸¬æ€§ç³»çµ±**å¾ˆå°‘**ç›´æ¥ç”¨ Java ç¨‹åºä¾†æ¸¬è©¦ã€‚ä»¥ä¸‹æ˜¯æ¥­ç•Œä¸»æµçš„å¯¦éš›åšæ³•ï¼š

### ğŸ› ï¸ **1. åŸºæ–¼å·¥å…·çš„æ¸¬è©¦æ–¹æ³•**

#### **Synthetic Monitoring (åˆæˆç›£æ§)**

```yaml
# DataDog Synthetic Tests
synthetic_tests:
  - name: "API Health Check"
    type: api
    request:
      url: "https://api.example.com/health"
      method: GET
    assertions:
      - type: statusCode
        operator: is
        value: 200
      - type: responseTime
        operator: lessThan
        value: 2000
    locations: ["aws:us-east-1", "aws:eu-west-1"]
    frequency: 300 # 5 minutes

  - name: "User Journey Test"
    type: browser
    steps:
      - type: click
        element: "#login-button"
      - type: type
        element: "#username"
        text: "test@example.com"
    locations: ["aws:us-east-1"]
    frequency: 900 # 15 minutes
```

#### **Chaos Engineering æ¸¬è©¦**

```yaml
# Chaos Monkey / Litmus é…ç½®
chaos_experiments:
  - name: "pod-delete"
    spec:
      components:
        env:
          - name: TOTAL_CHAOS_DURATION
            value: "60"
          - name: CHAOS_INTERVAL
            value: "10"
      probe:
        - name: "check-observability-metrics"
          type: "httpProbe"
          httpProbe/inputs:
            url: "http://prometheus:9090/api/v1/query"
            method:
              get:
                criteria: "=="
                responseCode: "200"
```

### ğŸ”§ **2. åŸºæ–¼è…³æœ¬çš„æ¸¬è©¦æ–¹æ³•**

#### **Bash/Shell è…³æœ¬æ¸¬è©¦**

```bash
#!/bin/bash
# observability_health_check.sh

# æª¢æŸ¥ Prometheus æŒ‡æ¨™
check_prometheus_metrics() {
    echo "Checking Prometheus metrics..."
    
    # æª¢æŸ¥æ‡‰ç”¨æŒ‡æ¨™
    APP_METRICS=$(curl -s "http://prometheus:9090/api/v1/query?query=up{job=\"app\"}" | jq -r '.data.result[0].value[1]')
    if [ "$APP_METRICS" != "1" ]; then
        echo "âŒ Application metrics not available"
        exit 1
    fi
    
    # æª¢æŸ¥éŒ¯èª¤ç‡
    ERROR_RATE=$(curl -s "http://prometheus:9090/api/v1/query?query=rate(http_requests_total{status=~\"5..\"}[5m])" | jq -r '.data.result[0].value[1]')
    if (( $(echo "$ERROR_RATE > 0.01" | bc -l) )); then
        echo "âŒ Error rate too high: $ERROR_RATE"
        exit 1
    fi
    
    echo "âœ… Prometheus metrics healthy"
}

# æª¢æŸ¥æ—¥èªŒå®Œæ•´æ€§
check_log_completeness() {
    echo "Checking log completeness..."
    
    # æª¢æŸ¥æœ€è¿‘ 5 åˆ†é˜çš„æ—¥èªŒ
    LOG_COUNT=$(curl -s -G "http://elasticsearch:9200/logs-*/_search" \
        --data-urlencode 'q=@timestamp:[now-5m TO now]' | jq '.hits.total.value')
    
    if [ "$LOG_COUNT" -lt 100 ]; then
        echo "âŒ Insufficient logs in last 5 minutes: $LOG_COUNT"
        exit 1
    fi
    
    echo "âœ… Log completeness verified: $LOG_COUNT logs"
}

# æª¢æŸ¥è¿½è¹¤æ•¸æ“š
check_tracing_data() {
    echo "Checking tracing data..."
    
    # æª¢æŸ¥ Jaeger ä¸­çš„è¿½è¹¤
    TRACE_COUNT=$(curl -s "http://jaeger:16686/api/traces?service=app&lookback=5m" | jq '.data | length')
    
    if [ "$TRACE_COUNT" -lt 10 ]; then
        echo "âŒ Insufficient traces: $TRACE_COUNT"
        exit 1
    fi
    
    echo "âœ… Tracing data verified: $TRACE_COUNT traces"
}

# ä¸»åŸ·è¡Œæµç¨‹
main() {
    check_prometheus_metrics
    check_log_completeness  
    check_tracing_data
    echo "ğŸ‰ All observability checks passed!"
}

main "$@"
```

#### **Python è…³æœ¬æ¸¬è©¦**

```python
#!/usr/bin/env python3
# observability_validator.py

import requests
import json
import time
from datetime import datetime, timedelta

class ObservabilityValidator:
    def __init__(self, config):
        self.prometheus_url = config['prometheus_url']
        self.elasticsearch_url = config['elasticsearch_url']
        self.jaeger_url = config['jaeger_url']
    
    def validate_sli_slo(self):
        """é©—è­‰ SLI/SLO æŒ‡æ¨™"""
        print("ğŸ” Validating SLI/SLO metrics...")
        
        # æª¢æŸ¥å¯ç”¨æ€§ SLI (ç›®æ¨™: 99.9%)
        availability_query = 'avg_over_time(up{job="app"}[5m])'
        availability = self._query_prometheus(availability_query)
        
        if availability < 0.999:
            raise Exception(f"âŒ Availability SLI failed: {availability:.4f} < 0.999")
        
        # æª¢æŸ¥å»¶é² SLI (ç›®æ¨™: P95 < 2s)
        latency_query = 'histogram_quantile(0.95, rate(http_request_duration_seconds_bucket[5m]))'
        p95_latency = self._query_prometheus(latency_query)
        
        if p95_latency > 2.0:
            raise Exception(f"âŒ Latency SLI failed: P95={p95_latency:.2f}s > 2s")
        
        # æª¢æŸ¥éŒ¯èª¤ç‡ SLI (ç›®æ¨™: < 0.1%)
        error_rate_query = 'rate(http_requests_total{status=~"5.."}[5m]) / rate(http_requests_total[5m])'
        error_rate = self._query_prometheus(error_rate_query)
        
        if error_rate > 0.001:
            raise Exception(f"âŒ Error rate SLI failed: {error_rate:.4f} > 0.001")
        
        print("âœ… All SLI/SLO metrics within targets")
    
    def validate_log_pipeline(self):
        """é©—è­‰æ—¥èªŒç®¡é“å®Œæ•´æ€§"""
        print("ğŸ” Validating log pipeline...")
        
        # ç”Ÿæˆæ¸¬è©¦æ—¥èªŒ
        test_correlation_id = f"test-{int(time.time())}"
        self._generate_test_logs(test_correlation_id)
        
        # ç­‰å¾…æ—¥èªŒè™•ç†
        time.sleep(30)
        
        # é©—è­‰æ—¥èªŒæ˜¯å¦åˆ°é” Elasticsearch
        query = {
            "query": {
                "bool": {
                    "must": [
                        {"match": {"correlation_id": test_correlation_id}},
                        {"range": {"@timestamp": {"gte": "now-2m"}}}
                    ]
                }
            }
        }
        
        response = requests.post(
            f"{self.elasticsearch_url}/logs-*/_search",
            json=query
        )
        
        hits = response.json()['hits']['total']['value']
        if hits == 0:
            raise Exception(f"âŒ Test logs not found in Elasticsearch")
        
        print(f"âœ… Log pipeline validated: {hits} test logs processed")
    
    def validate_alerting_rules(self):
        """é©—è­‰å‘Šè­¦è¦å‰‡"""
        print("ğŸ” Validating alerting rules...")
        
        # æª¢æŸ¥ Prometheus å‘Šè­¦è¦å‰‡
        response = requests.get(f"{self.prometheus_url}/api/v1/rules")
        rules = response.json()['data']['groups']
        
        required_alerts = [
            'HighErrorRate',
            'HighLatency', 
            'ServiceDown',
            'DiskSpaceLow'
        ]
        
        active_alerts = []
        for group in rules:
            for rule in group['rules']:
                if rule['type'] == 'alerting':
                    active_alerts.append(rule['name'])
        
        missing_alerts = set(required_alerts) - set(active_alerts)
        if missing_alerts:
            raise Exception(f"âŒ Missing alert rules: {missing_alerts}")
        
        print(f"âœ… All required alert rules configured: {len(active_alerts)} rules")
    
    def _query_prometheus(self, query):
        """æŸ¥è©¢ Prometheus æŒ‡æ¨™"""
        response = requests.get(
            f"{self.prometheus_url}/api/v1/query",
            params={'query': query}
        )
        result = response.json()['data']['result']
        return float(result[0]['value'][1]) if result else 0.0
    
    def _generate_test_logs(self, correlation_id):
        """ç”Ÿæˆæ¸¬è©¦æ—¥èªŒ"""
        # èª¿ç”¨æ‡‰ç”¨ API ç”Ÿæˆæ—¥èªŒ
        requests.get(
            "http://app:8080/api/test/logs",
            headers={"X-Correlation-ID": correlation_id}
        )

# ä½¿ç”¨ç¯„ä¾‹
if __name__ == "__main__":
    config = {
        'prometheus_url': 'http://prometheus:9090',
        'elasticsearch_url': 'http://elasticsearch:9200',
        'jaeger_url': 'http://jaeger:16686'
    }
    
    validator = ObservabilityValidator(config)
    
    try:
        validator.validate_sli_slo()
        validator.validate_log_pipeline()
        validator.validate_alerting_rules()
        print("ğŸ‰ All observability validations passed!")
    except Exception as e:
        print(f"ğŸ’¥ Validation failed: {e}")
        exit(1)
```

### ğŸš€ **3. CI/CD ç®¡é“ä¸­çš„æ¸¬è©¦**

#### **GitLab CI ç¯„ä¾‹**

```yaml
# .gitlab-ci.yml
stages:
  - build
  - test
  - deploy
  - observability-test

observability-smoke-test:
  stage: observability-test
  image: alpine/curl
  script:
    - apk add --no-cache jq bc
    - ./scripts/observability_health_check.sh
  only:
    - main
  when: on_success

observability-sli-validation:
  stage: observability-test
  image: python:3.9-alpine
  script:
    - pip install requests
    - python scripts/observability_validator.py
  only:
    - main
  when: on_success
  allow_failure: false

chaos-engineering-test:
  stage: observability-test
  image: litmuschaos/litmus-checker:latest
  script:
    - litmus run chaos-experiments/pod-delete.yaml
    - litmus validate --experiment-name pod-delete
  only:
    - schedules
  when: manual
```

#### **GitHub Actions ç¯„ä¾‹**

```yaml
# .github/workflows/observability-test.yml
name: Observability Testing

on:
  push:
    branches: [main]
  schedule:
    - cron: '0 */6 * * *'  # æ¯ 6 å°æ™‚åŸ·è¡Œä¸€æ¬¡

jobs:
  synthetic-monitoring:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3
      
      - name: Run Synthetic Tests
        uses: datadog/synthetics-ci-github-action@v1
        with:
          api_key: ${{ secrets.DATADOG_API_KEY }}
          app_key: ${{ secrets.DATADOG_APP_KEY }}
          test_search_query: 'tag:observability'
          
  sli-slo-validation:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3
      
      - name: Setup Python
        uses: actions/setup-python@v4
        with:
          python-version: '3.9'
          
      - name: Install dependencies
        run: pip install requests prometheus-client
        
      - name: Validate SLI/SLO
        run: python scripts/sli_slo_validator.py
        env:
          PROMETHEUS_URL: ${{ secrets.PROMETHEUS_URL }}
          
  load-test-observability:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3
      
      - name: Run K6 Load Test
        uses: grafana/k6-action@v0.2.0
        with:
          filename: tests/load-test-observability.js
        env:
          K6_PROMETHEUS_RW_SERVER_URL: ${{ secrets.PROMETHEUS_URL }}
```

### ğŸ“Š **4. åŸºæ–¼ K6 çš„è² è¼‰æ¸¬è©¦**

```javascript
// tests/load-test-observability.js
import http from 'k6/http';
import { check, sleep } from 'k6';
import { Rate, Trend } from 'k6/metrics';

// è‡ªå®šç¾©æŒ‡æ¨™
const errorRate = new Rate('errors');
const observabilityOverhead = new Trend('observability_overhead');

export const options = {
  stages: [
    { duration: '2m', target: 10 },   // æš–èº«
    { duration: '5m', target: 50 },   // æ­£å¸¸è² è¼‰
    { duration: '2m', target: 100 },  // å³°å€¼è² è¼‰
    { duration: '5m', target: 100 },  // ç¶­æŒå³°å€¼
    { duration: '2m', target: 0 },    // é™è¼‰
  ],
  thresholds: {
    http_req_duration: ['p(95)<2000'], // P95 < 2s
    errors: ['rate<0.01'],             // éŒ¯èª¤ç‡ < 1%
    observability_overhead: ['avg<50'], // å¯è§€æ¸¬æ€§é–‹éŠ· < 50ms
  },
};

export default function () {
  // æ¸¬è©¦ä¸»è¦æ¥­å‹™ API
  const startTime = Date.now();
  
  const response = http.get('http://app:8080/api/orders', {
    headers: {
      'X-Correlation-ID': `k6-test-${__VU}-${__ITER}`,
      'X-Load-Test': 'true',
    },
  });
  
  const endTime = Date.now();
  
  // æª¢æŸ¥éŸ¿æ‡‰
  const success = check(response, {
    'status is 200': (r) => r.status === 200,
    'response time < 2s': (r) => r.timings.duration < 2000,
    'has correlation header': (r) => r.headers['X-Correlation-ID'] !== undefined,
  });
  
  errorRate.add(!success);
  
  // æ¸¬è©¦å¯è§€æ¸¬æ€§ç«¯é»çš„é–‹éŠ·
  const metricsStart = Date.now();
  const metricsResponse = http.get('http://app:8080/actuator/metrics');
  const metricsEnd = Date.now();
  
  observabilityOverhead.add(metricsEnd - metricsStart);
  
  sleep(1);
}

export function handleSummary(data) {
  return {
    'observability-test-results.json': JSON.stringify(data, null, 2),
  };
}
```

### ğŸ” **5. åŸºæ–¼ Terraform çš„åŸºç¤è¨­æ–½æ¸¬è©¦**

```hcl
# tests/observability_test.tf
resource "test_assertions" "observability_stack" {
  component = "observability"

  equal "cloudwatch_log_groups_exist" {
    description = "CloudWatch log groups should exist"
    got         = length(data.aws_cloudwatch_log_groups.app_logs.log_group_names)
    want        = 3
  }

  equal "prometheus_targets_healthy" {
    description = "All Prometheus targets should be healthy"
    got = length([
      for target in data.prometheus_targets.all.targets :
      target if target.health == "up"
    ])
    want = length(data.prometheus_targets.all.targets)
  }

  check "xray_service_map_exists" {
    description = "X-Ray service map should show our services"
    condition = length(data.aws_xray_service_graph.app.services) > 0
  }
}

# ä½¿ç”¨ Terratest é€²è¡Œæ¸¬è©¦
resource "null_resource" "run_terratest" {
  provisioner "local-exec" {
    command = "cd tests && go test -v -timeout 30m"
  }
}
```

### ğŸ¯ **æ¥­ç•Œå¯¦éš›æ¸¬è©¦ç­–ç•¥ç¸½çµ**

| æ¸¬è©¦é¡å‹ | ä¸»è¦å·¥å…· | ä½¿ç”¨å ´æ™¯ | è‡ªå‹•åŒ–ç¨‹åº¦ |
|---------|---------|---------|-----------|
| **Synthetic Monitoring** | DataDog, New Relic, Pingdom | æŒçºŒç›£æ§ç”¨æˆ¶é«”é©— | ğŸŸ¢ å®Œå…¨è‡ªå‹•åŒ– |
| **SLI/SLO é©—è­‰** | Prometheus + Python/Bash | CI/CD ç®¡é“å“è³ªé–€æª» | ğŸŸ¢ å®Œå…¨è‡ªå‹•åŒ– |
| **Chaos Engineering** | Chaos Monkey, Litmus | å®šæœŸéŸŒæ€§æ¸¬è©¦ | ğŸŸ¡ åŠè‡ªå‹•åŒ– |
| **Load Testing** | K6, JMeter, Artillery | æ€§èƒ½å’Œå¯è§€æ¸¬æ€§é–‹éŠ·æ¸¬è©¦ | ğŸŸ¢ å®Œå…¨è‡ªå‹•åŒ– |
| **Infrastructure Testing** | Terratest, InSpec | åŸºç¤è¨­æ–½é…ç½®é©—è­‰ | ğŸŸ¢ å®Œå…¨è‡ªå‹•åŒ– |
| **Manual Validation** | Grafana, Kibana å„€è¡¨æ¿ | æ·±åº¦åˆ†æå’Œæ•…éšœæ’é™¤ | ğŸ”´ æ‰‹å‹•æ“ä½œ |

### ğŸ’¡ **é—œéµæ´å¯Ÿ**

1. **Java æ¸¬è©¦ç¨‹åºä¸»è¦ç”¨æ–¼**:
   - å–®å…ƒæ¸¬è©¦å’Œé›†æˆæ¸¬è©¦éšæ®µ
   - é–‹ç™¼ç’°å¢ƒçš„å¿«é€Ÿé©—è­‰
   - ç‰¹å®šæ¥­å‹™é‚è¼¯çš„å¯è§€æ¸¬æ€§æ¸¬è©¦

2. **ç”Ÿç”¢ç’°å¢ƒä¸»è¦ä½¿ç”¨**:
   - åŸºæ–¼è…³æœ¬çš„è‡ªå‹•åŒ–æ¸¬è©¦ (Bash/Python)
   - ç¬¬ä¸‰æ–¹ç›£æ§å·¥å…·çš„ Synthetic Tests
   - CI/CD ç®¡é“ä¸­çš„å“è³ªé–€æª»æª¢æŸ¥
   - Chaos Engineering å·¥å…·

3. **æœ€ä½³å¯¦è¸çµ„åˆ**:
   - é–‹ç™¼éšæ®µ: Java å–®å…ƒæ¸¬è©¦ + é›†æˆæ¸¬è©¦
   - CI/CD éšæ®µ: è…³æœ¬åŒ–é©—è­‰ + SLI/SLO æª¢æŸ¥
   - ç”Ÿç”¢éšæ®µ: Synthetic Monitoring + Chaos Testing
   - æŒçºŒæ”¹é€²: å®šæœŸæ‰‹å‹•åˆ†æ + è‡ªå‹•åŒ–å ±å‘Š

é€™æ¨£çš„çµ„åˆèƒ½å¤ åœ¨ä¸åŒéšæ®µæä¾›é©ç•¶çš„æ¸¬è©¦è¦†è“‹ï¼Œæ—¢ä¿è­‰äº†é–‹ç™¼æ•ˆç‡ï¼Œä¹Ÿç¢ºä¿äº†ç”Ÿç”¢ç’°å¢ƒçš„å¯é æ€§ã€‚
