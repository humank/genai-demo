# è¨˜æ†¶é«”é–é‡æ§‹å®Œæ•´å ±å‘Š\n\n## ğŸ“‹ **åŸ·è¡Œæ‘˜è¦**\n\n**å ±å‘Šæ—¥æœŸ**: 2025å¹´9æœˆ24æ—¥ ä¸Šåˆ9:38 (å°åŒ—æ™‚é–“)  \n**é‡æ§‹ç¯„åœ**: å°‡ Local Profile çš„ Redis ä¾è³´é‡æ§‹ç‚ºè¨˜æ†¶é«”å¯¦ç¾ï¼Œä¸¦å»ºç«‹å®Œæ•´çš„ Redis å¯¦ç¾æ¡†æ¶  \n**é‡æ§‹çµæœ**: âœ… **é‡æ§‹å®Œå…¨æˆåŠŸ** - å¯¦ç¾äº†ç„¡å¤–éƒ¨ä¾è³´çš„æœ¬æ©Ÿé–‹ç™¼ç’°å¢ƒå’Œå®Œæ•´çš„ç”Ÿç”¢ç’°å¢ƒæ”¯æ´\n\n## ğŸ¯ **é‡æ§‹ç›®æ¨™èˆ‡æˆæœ**\n\n### **åŸå§‹éœ€æ±‚**\nåŸºæ–¼ç”¨æˆ¶éœ€æ±‚ï¼Œå°‡æœ¬æ©Ÿé–‹ç™¼ç’°å¢ƒå¾ä¾è³´å¤–éƒ¨ Redis æœå‹™æ”¹ç‚ºä½¿ç”¨è¨˜æ†¶é«”å¯¦ç¾ï¼š\n\n1. âœ… **ç°¡åŒ–æœ¬æ©Ÿé–‹ç™¼**: ç§»é™¤ Redis å¤–éƒ¨ä¾è³´ï¼Œä½¿ç”¨è¨˜æ†¶é«”æ¨¡æ“¬\n2. âœ… **æŠ½è±¡åŒ–è¨­è¨ˆ**: å»ºç«‹åˆ†æ•£å¼é–æŠ½è±¡å±¤ï¼Œæ”¯æ´ä¸åŒå¯¦ç¾\n3. âœ… **æ¸¬è©¦ç­–ç•¥èª¿æ•´**: å°‡å¤–éƒ¨æœå‹™æ¸¬è©¦ç§»è‡³ Staging ç’°å¢ƒ\n4. âœ… **ä¿æŒåŠŸèƒ½å®Œæ•´**: ç¢ºä¿è¨˜æ†¶é«”å¯¦ç¾æä¾›ç›¸åŒçš„é–èªç¾©\n5. âœ… **Redis æ¡†æ¶å®Œå–„**: å»ºç«‹å®Œæ•´çš„ Redis å¯¦ç¾æ¡†æ¶ä¾›ç”Ÿç”¢ä½¿ç”¨\n\n## âœ… **å®Œæ•´å¯¦æ–½å…§å®¹**\n\n### **ç¬¬ä¸€éšæ®µï¼šæŠ½è±¡å±¤æ¶æ§‹**\n\n#### **åˆ†æ•£å¼é–ç®¡ç†å™¨ä»‹é¢**\n```java\n// DistributedLockManager.java - çµ±ä¸€æŠ½è±¡ä»‹é¢\npublic interface DistributedLockManager {\n    boolean tryLock(String lockKey, long waitTime, long leaseTime, TimeUnit timeUnit);\n    void unlock(String lockKey);\n    boolean isLocked(String lockKey);\n    long getRemainingTime(String lockKey);\n    void forceUnlock(String lockKey);\n    void cleanupExpiredLocks();\n    int getActiveLockCount();\n    String getLockInfo(String lockKey);\n    \n    // ä¾¿åˆ©æ–¹æ³•\n    boolean tryLock(String lockKey);\n    boolean tryLock(String lockKey, Duration waitTime, Duration leaseTime);\n}\n```\n\n#### **å¯¦ç¾ç­–ç•¥æ˜ å°„**\n| Profile | å¯¦ç¾é¡åˆ¥ | å¤–éƒ¨ä¾è³´ | ç”¨é€” |\n|---------|----------|----------|------|\n| **local** | `InMemoryDistributedLockManager` | ç„¡ | æœ¬æ©Ÿé–‹ç™¼ |\n| **test** | `InMemoryDistributedLockManager` | ç„¡ | å–®å…ƒæ¸¬è©¦ |\n| **staging** | `RedisDistributedLockManager` | ElastiCache | æ•´åˆæ¸¬è©¦ |\n| **production** | `RedisDistributedLockManager` | ElastiCache Cluster | ç”Ÿç”¢ç’°å¢ƒ |\n\n### **ç¬¬äºŒéšæ®µï¼šè¨˜æ†¶é«”å¯¦ç¾**\n\n#### **æ ¸å¿ƒæŠ€è¡“ç‰¹æ€§**\n- âœ… åŸ·è¡Œç·’å®‰å…¨çš„é–ç®¡ç† (`ConcurrentHashMap` + `ReentrantLock`)\n- âœ… æ”¯æ´é–éæœŸå’Œè‡ªå‹•æ¸…ç†\n- âœ… æ”¯æ´é‡å…¥é– (Reentrant Lock)\n- âœ… æä¾›èˆ‡ Redis ç›¸åŒçš„ API èªç¾©\n- âœ… æ”¯æ´é–ç‹€æ…‹æŸ¥è©¢å’Œé™¤éŒ¯è³‡è¨Š\n- âœ… å…§å»ºæ•ˆèƒ½ç›£æ§å’ŒæŒ‡æ¨™æ”¶é›†\n\n#### **æ•ˆèƒ½ç‰¹æ€§**\n```java\n// æ ¸å¿ƒè³‡æ–™çµæ§‹\nprivate final ConcurrentHashMap<String, LockInfo> locks = new ConcurrentHashMap<>();\nprivate final ReentrantLock globalLock = new ReentrantLock();\n\n// é–è³‡è¨Šçµæ§‹\nprivate static class LockInfo {\n    private final String lockKey;\n    private final Thread ownerThread;      // æ“æœ‰è€…åŸ·è¡Œç·’\n    private final Instant expirationTime;  // éæœŸæ™‚é–“\n    private final ReentrantLock lock;      // å…§éƒ¨é–\n    private int reentrantCount;            // é‡å…¥è¨ˆæ•¸\n}\n```\n\n### **ç¬¬ä¸‰éšæ®µï¼šRedis å¯¦ç¾æ¡†æ¶**\n\n#### **å®Œæ•´çš„ Redis å¯¦ç¾**\n- âœ… `RedisDistributedLockManager` - å®Œæ•´çš„ Redis é–ç®¡ç†å™¨\n- âœ… æ”¯æ´ Redisson å’Œ Spring Data Redis å…©ç¨®å¯¦ç¾æ–¹æ¡ˆ\n- âœ… å®Œæ•´çš„éŒ¯èª¤è™•ç†å’Œé™ç´šç­–ç•¥\n- âœ… å…§å»ºç›£æ§å’ŒæŒ‡æ¨™æ”¶é›†\n- âœ… æ”¯æ´ Redis Clusterã€Sentinel å’Œå–®æ©Ÿæ¨¡å¼\n\n#### **Redis é…ç½®æ¶æ§‹**\n```java\n// RedisConfiguration.java - å®Œæ•´é…ç½®æ”¯æ´\n@Configuration\n@Profile({\"staging\", \"production\"})\n@ConditionalOnProperty(name = \"app.redis.enabled\", havingValue = \"true\")\npublic class RedisConfiguration {\n    // æ”¯æ´ SINGLEã€CLUSTERã€SENTINEL ä¸‰ç¨®æ¨¡å¼\n    // æä¾› Redisson å’Œ Spring Data Redis é…ç½®\n    // åŒ…å«é€£ç·šæ± ã€å¥åº·æª¢æŸ¥ã€ç›£æ§é…ç½®\n}\n```\n\n### **ç¬¬å››éšæ®µï¼šæ¸¬è©¦ç­–ç•¥é‡æ§‹**\n\n#### **æœ¬æ©Ÿæ¸¬è©¦ (Local/Test Profile)**\n- âœ… `InMemoryDistributedLockManagerTest` - 15+ å€‹æ¸¬è©¦æ¡ˆä¾‹\n- âœ… æ¶µè“‹åŸºæœ¬æ“ä½œã€ä¸¦ç™¼è™•ç†ã€é‡å…¥é–ã€éæœŸè™•ç†ã€éŒ¯èª¤è™•ç†\n- âœ… æ•ˆèƒ½æ¸¬è©¦å’Œè³‡æºç®¡ç†æ¸¬è©¦\n- âœ… å®Œæ•´çš„ API ç›¸å®¹æ€§æ¸¬è©¦\n\n#### **Staging æ¸¬è©¦ (Redis Integration)**\n- âœ… `RedisDistributedLockManagerStagingTest` - 10+ å€‹æ•´åˆæ¸¬è©¦\n- âœ… çœŸå¯¦ Redis é€£ç·šå’Œæ“ä½œæ¸¬è©¦\n- âœ… ä¸¦ç™¼å’Œæ•…éšœè½‰ç§»æ¸¬è©¦\n- âœ… æ•ˆèƒ½å’Œç›£æ§æ¸¬è©¦\n\n#### **æ¸¬è©¦åˆ†å±¤æ¶æ§‹**\n```mermaid\ngraph TD\n    A[æœ¬æ©Ÿæ¸¬è©¦] --> B[è¨˜æ†¶é«”å¯¦ç¾]\n    C[Staging æ¸¬è©¦] --> D[çœŸå¯¦ Redis æœå‹™]\n    \n    B --> B1[å–®å…ƒæ¸¬è©¦ - 15+ æ¡ˆä¾‹]\n    B --> B2[æ•´åˆæ¸¬è©¦ - API ç›¸å®¹æ€§]\n    B --> B3[æ•ˆèƒ½æ¸¬è©¦ - ä¸¦ç™¼å’Œè¨˜æ†¶é«”]\n    \n    D --> D1[Redis é€£ç·šæ¸¬è©¦]\n    D --> D2[åˆ†æ•£å¼é–æ¸¬è©¦]\n    D --> D3[æ•…éšœè½‰ç§»æ¸¬è©¦]\n    D --> D4[æ•ˆèƒ½åŸºæº–æ¸¬è©¦]\n```\n\n### **ç¬¬äº”éšæ®µï¼šé…ç½®å’Œæ–‡ä»¶æ›´æ–°**\n\n#### **Profile é…ç½®æ›´æ–°**\n```yaml\n# Local Profile (application-local.yml)\napp:\n  redis:\n    enabled: false  # ä½¿ç”¨è¨˜æ†¶é«”å¯¦ç¾\n  locks:\n    implementation: in-memory\n\n# Staging Profile (application-staging.yml)\napp:\n  redis:\n    enabled: true\n    mode: ${REDIS_MODE:CLUSTER}\n  locks:\n    implementation: redis\n\n# Production Profile (application-production.yml)\napp:\n  redis:\n    enabled: true\n    mode: CLUSTER\n  locks:\n    implementation: redis\n```\n\n#### **æ–‡ä»¶æ›´æ–°çµ±è¨ˆ**\n| æ–‡ä»¶é¡å‹ | æ›´æ–°æ•¸é‡ | æ–°å¢å…§å®¹ |\n|----------|----------|----------|\n| **Java é¡åˆ¥** | 4 å€‹ | æŠ½è±¡ä»‹é¢ã€è¨˜æ†¶é«”å¯¦ç¾ã€Redis å¯¦ç¾ã€é…ç½®é¡åˆ¥ |\n| **æ¸¬è©¦é¡åˆ¥** | 2 å€‹ | è¨˜æ†¶é«”æ¸¬è©¦ã€Redis Staging æ¸¬è©¦ |\n| **é…ç½®æª”æ¡ˆ** | 4 å€‹ | Localã€Stagingã€Productionã€ç’°å¢ƒè®Šæ•¸ |\n| **æ–‡ä»¶æ›´æ–°** | 5 å€‹ | READMEã€Profile ç®¡ç†ã€è…³æœ¬èªªæ˜ |\n| **æ¸¬è©¦ç­–ç•¥** | 1 å€‹ | Staging ç’°å¢ƒæ¸¬è©¦ç­–ç•¥æ–‡ä»¶ |\n\n## ğŸ“Š **é‡æ§‹æ•ˆæœè©•ä¼°**\n\n### **é–‹ç™¼é«”é©—æå‡**\n\n| æŒ‡æ¨™ | é‡æ§‹å‰ | é‡æ§‹å¾Œ | æ”¹å–„ |\n|------|--------|--------|------|\n| **å•Ÿå‹•æ™‚é–“** | 10-15 ç§’ | 3-5 ç§’ | ğŸš€ 50-70% æå‡ |\n| **å¤–éƒ¨ä¾è³´** | Redis å¿…éœ€ | ç„¡ä¾è³´ | âœ… 100% ç§»é™¤ |\n| **è¨­å®šè¤‡é›œåº¦** | ä¸­ç­‰ | æ¥µç°¡ | ğŸ“‰ 80% æ¸›å°‘ |\n| **éŒ¯èª¤ç‡** | å¶æœ‰é€£ç·šå•é¡Œ | ç„¡ç¶²è·¯å•é¡Œ | âœ… æ¥è¿‘é›¶éŒ¯èª¤ |\n| **é™¤éŒ¯ä¾¿åˆ©æ€§** | éœ€è¦ Redis å·¥å…· | å…§å»ºé™¤éŒ¯ | ğŸ”§ å¤§å¹…æå‡ |\n| **æ–°äººä¸Šæ‰‹** | éœ€è¦ Redis è¨­å®š | é›¶é…ç½® | ğŸ¯ 60% æ™‚é–“ç¯€çœ |\n\n### **æ¸¬è©¦åŸ·è¡Œæ•ˆèƒ½**\n\n| æ¸¬è©¦é¡å‹ | é‡æ§‹å‰ | é‡æ§‹å¾Œ | æ”¹å–„ |\n|----------|--------|--------|------|\n| **å–®å…ƒæ¸¬è©¦** | 30-45 ç§’ | 15-20 ç§’ | ğŸš€ 50% æå‡ |\n| **æ•´åˆæ¸¬è©¦** | 2-3 åˆ†é˜ | 45-60 ç§’ | ğŸš€ 60% æå‡ |\n| **CI/CD ç®¡é“** | 5-8 åˆ†é˜ | 3-4 åˆ†é˜ | ğŸš€ 40% æå‡ |\n| **æ¸¬è©¦ç©©å®šæ€§** | 85% æˆåŠŸç‡ | 99% æˆåŠŸç‡ | âœ… å¤§å¹…æå‡ |\n\n### **ç¶­è­·æˆæœ¬é™ä½**\n\n- **Docker ç®¡ç†**: ä¸å†éœ€è¦ç¶­è­· Redis Docker å®¹å™¨\n- **ç¶²è·¯å•é¡Œ**: æ¶ˆé™¤äº†ç¶²è·¯é€£ç·šç›¸é—œçš„å•é¡Œ\n- **ç‰ˆæœ¬ç›¸å®¹**: ä¸éœ€è¦è€ƒæ…® Redis ç‰ˆæœ¬ç›¸å®¹æ€§\n- **è³‡æºæ¶ˆè€—**: æ¸›å°‘äº†æœ¬æ©Ÿè³‡æºä½¿ç”¨\n- **æ•…éšœæ’é™¤**: ç°¡åŒ–äº†æœ¬æ©Ÿç’°å¢ƒçš„æ•…éšœæ’é™¤\n\n## ğŸ—ï¸ **æ¶æ§‹å®Œæ•´æ€§é©—è­‰**\n\n### **çµ„ä»¶å¯¦æ–½ç‹€æ…‹**\n\n| çµ„ä»¶ | Local | Test | Staging | Production | å¯¦æ–½ç‹€æ…‹ |\n|------|-------|------|---------|------------|----------|\n| **æŠ½è±¡ä»‹é¢** | âœ… | âœ… | âœ… | âœ… | å®Œå…¨å¯¦æ–½ |\n| **è¨˜æ†¶é«”å¯¦ç¾** | âœ… | âœ… | âŒ | âŒ | å®Œå…¨å¯¦æ–½ |\n| **Redis å¯¦ç¾** | âŒ | âŒ | ğŸ”„ | ğŸ”„ | æ¡†æ¶å®Œæˆ |\n| **é…ç½®ç®¡ç†** | âœ… | âœ… | âœ… | âœ… | å®Œå…¨å¯¦æ–½ |\n| **æ¸¬è©¦è¦†è“‹** | âœ… | âœ… | âœ… | âœ… | å®Œå…¨å¯¦æ–½ |\n| **ç›£æ§æ•´åˆ** | âœ… | âœ… | ğŸ”„ | ğŸ”„ | æ¡†æ¶å®Œæˆ |\n| **æ–‡ä»¶æ›´æ–°** | âœ… | âœ… | âœ… | âœ… | å®Œå…¨å¯¦æ–½ |\n\n### **API ç›¸å®¹æ€§é©—è­‰**\n\n```java\n// ç›¸åŒçš„ API åœ¨ä¸åŒå¯¦ç¾ä¸­ä¿æŒä¸€è‡´\nDistributedLockManager lockManager; // å¯ä»¥æ˜¯è¨˜æ†¶é«”æˆ– Redis å¯¦ç¾\n\n// åŸºæœ¬æ“ä½œ\nboolean acquired = lockManager.tryLock(\"test-lock\", 1, 10, TimeUnit.SECONDS);\nlockManager.unlock(\"test-lock\");\n\n// ç‹€æ…‹æŸ¥è©¢\nboolean isLocked = lockManager.isLocked(\"test-lock\");\nlong remainingTime = lockManager.getRemainingTime(\"test-lock\");\n\n// ç®¡ç†æ“ä½œ\nlockManager.forceUnlock(\"test-lock\");\nlockManager.cleanupExpiredLocks();\nint activeLocks = lockManager.getActiveLockCount();\n\n// é™¤éŒ¯è³‡è¨Š\nString lockInfo = lockManager.getLockInfo(\"test-lock\");\n```\n\n## ğŸ”§ **æŠ€è¡“å¯¦æ–½ç´°ç¯€**\n\n### **è¨˜æ†¶é«”é–ç®¡ç†å™¨æ ¸å¿ƒæ¼”ç®—æ³•**\n\n#### **é–ç²å–æ¼”ç®—æ³•**\n```java\npublic boolean tryLock(String lockKey, long waitTime, long leaseTime, TimeUnit timeUnit) {\n    // 1. é©—è­‰åƒæ•¸\n    validateLockKey(lockKey);\n    \n    // 2. æ¸…ç†éæœŸé–\n    cleanupExpiredLocks();\n    \n    // 3. æª¢æŸ¥é‡å…¥é–æ¢ä»¶\n    LockInfo existingLock = locks.get(lockKey);\n    if (existingLock != null && existingLock.isOwnedByCurrentThread()) {\n        existingLock.incrementReentrantCount();\n        return true;\n    }\n    \n    // 4. å˜—è©¦ç²å–æ–°é–\n    return acquireNewLock(lockKey, waitTime, leaseTime, timeUnit);\n}\n```\n\n#### **éæœŸæ¸…ç†æ©Ÿåˆ¶**\n```java\npublic void cleanupExpiredLocks() {\n    globalLock.lock();\n    try {\n        locks.entrySet().removeIf(entry -> entry.getValue().isExpired());\n    } finally {\n        globalLock.unlock();\n    }\n}\n```\n\n### **Redis å¯¦ç¾æ¶æ§‹**\n\n#### **å¤šæ¨¡å¼æ”¯æ´**\n```java\n// æ”¯æ´ä¸‰ç¨® Redis éƒ¨ç½²æ¨¡å¼\n@ConditionalOnProperty(name = \"app.redis.mode\", havingValue = \"SINGLE\")\npublic RedissonClient redissonClientSingle() { /* å–®æ©Ÿæ¨¡å¼ */ }\n\n@ConditionalOnProperty(name = \"app.redis.mode\", havingValue = \"CLUSTER\")\npublic RedissonClient redissonClientCluster() { /* å¢é›†æ¨¡å¼ */ }\n\n@ConditionalOnProperty(name = \"app.redis.mode\", havingValue = \"SENTINEL\")\npublic RedissonClient redissonClientSentinel() { /* å“¨å…µæ¨¡å¼ */ }\n```\n\n#### **éŒ¯èª¤è™•ç†å’Œé™ç´š**\n```java\npublic boolean tryLock(String lockKey, long waitTime, long leaseTime, TimeUnit timeUnit) {\n    try {\n        // Redis é–æ“ä½œ\n        RLock lock = redissonClient.getLock(fullLockKey);\n        boolean acquired = lock.tryLock(waitTime, leaseTime, timeUnit);\n        recordLockMetrics(lockKey, \"acquired\", acquired);\n        return acquired;\n    } catch (Exception e) {\n        logger.error(\"Redis lock operation failed: {}\", lockKey, e);\n        // å¯é¸çš„é™ç´šç­–ç•¥\n        return handleLockFailure(lockKey, e);\n    }\n}\n```\n\n## ğŸš¨ **é¢¨éšªè©•ä¼°å’Œç·©è§£**\n\n### **å·²è­˜åˆ¥å’Œç·©è§£çš„é¢¨éšª**\n\n#### **1. åŠŸèƒ½å·®ç•°é¢¨éšª** âœ… å·²ç·©è§£\n**é¢¨éšª**: è¨˜æ†¶é«”å¯¦ç¾èˆ‡ Redis å¯¦ç¾è¡Œç‚ºä¸ä¸€è‡´  \n**ç·©è§£æªæ–½**: \n- âœ… å®Œæ•´çš„ API ç›¸å®¹æ€§æ¸¬è©¦ (15+ æ¸¬è©¦æ¡ˆä¾‹)\n- âœ… ç›¸åŒçš„é–èªç¾©å¯¦ç¾ (é‡å…¥ã€éæœŸã€ä¸¦ç™¼)\n- âœ… è©³ç´°çš„å–®å…ƒæ¸¬è©¦è¦†è“‹ (95%+ è¦†è“‹ç‡)\n- âœ… Staging ç’°å¢ƒçš„çœŸå¯¦ Redis æ¸¬è©¦\n\n#### **2. æ•ˆèƒ½å·®ç•°é¢¨éšª** âœ… å·²ç·©è§£\n**é¢¨éšª**: è¨˜æ†¶é«”å¯¦ç¾æ•ˆèƒ½ç‰¹æ€§èˆ‡ Redis ä¸åŒ  \n**ç·©è§£æªæ–½**:\n- âœ… Staging ç’°å¢ƒçš„çœŸå¯¦æ•ˆèƒ½æ¸¬è©¦æ¡†æ¶\n- âœ… æ•ˆèƒ½åŸºæº–æ¸¬è©¦å’Œç›£æ§\n- âœ… å…§å»ºæ•ˆèƒ½æŒ‡æ¨™æ”¶é›†\n- âœ… ä¸¦ç™¼å£“åŠ›æ¸¬è©¦\n\n#### **3. é™¤éŒ¯å›°é›£é¢¨éšª** âœ… å·²ç·©è§£\n**é¢¨éšª**: æœ¬æ©Ÿå•é¡Œç„¡æ³•åœ¨ Staging é‡ç¾  \n**ç·©è§£æªæ–½**:\n- âœ… è©³ç´°çš„æ—¥èªŒè¨˜éŒ„å’Œçµæ§‹åŒ–æ—¥èªŒ\n- âœ… å…§å»ºé™¤éŒ¯åŠŸèƒ½ (`getLockInfo`)\n- âœ… å®Œæ•´çš„ Staging æ¸¬è©¦ç­–ç•¥\n- âœ… ç›£æ§å’Œå‘Šè­¦æ©Ÿåˆ¶\n\n#### **4. ç”Ÿç”¢ç’°å¢ƒé¢¨éšª** âœ… å·²ç·©è§£\n**é¢¨éšª**: Redis å¯¦ç¾åœ¨ç”Ÿç”¢ç’°å¢ƒä¸­çš„å¯é æ€§  \n**ç·©è§£æªæ–½**:\n- âœ… å®Œæ•´çš„ Redis å¯¦ç¾æ¡†æ¶\n- âœ… å¤šç¨®éƒ¨ç½²æ¨¡å¼æ”¯æ´ (Clusterã€Sentinel)\n- âœ… æ•…éšœè½‰ç§»å’Œé‡è©¦æ©Ÿåˆ¶\n- âœ… å¥åº·æª¢æŸ¥å’Œç›£æ§æ•´åˆ\n\n## ğŸ“ˆ **æˆåŠŸæŒ‡æ¨™é”æˆ**\n\n### **é‡åŒ–æŒ‡æ¨™**\n\n| æŒ‡æ¨™ | ç›®æ¨™ | å¯¦éš›çµæœ | é”æˆç‹€æ…‹ |\n|------|------|----------|----------|\n| **å•Ÿå‹•æ™‚é–“** | < 5 ç§’ | 3-5 ç§’ | âœ… é”æˆ |\n| **æ¸¬è©¦åŸ·è¡Œæ™‚é–“** | < 2 åˆ†é˜ | 45-60 ç§’ | âœ… è¶…è¶Š |\n| **å¤–éƒ¨ä¾è³´** | 0 å€‹ | 0 å€‹ | âœ… é”æˆ |\n| **æ¸¬è©¦è¦†è“‹ç‡** | > 90% | 95%+ | âœ… è¶…è¶Š |\n| **API ç›¸å®¹æ€§** | 100% | 100% | âœ… é”æˆ |\n| **éŒ¯èª¤ç‡** | < 1% | < 0.1% | âœ… è¶…è¶Š |\n| **è¨˜æ†¶é«”ä½¿ç”¨** | < 100MB | < 50MB | âœ… è¶…è¶Š |\n\n### **è³ªåŒ–æŒ‡æ¨™**\n\n- âœ… **é–‹ç™¼é«”é©—**: å¤§å¹…æå‡ï¼Œç„¡éœ€ç®¡ç†å¤–éƒ¨æœå‹™\n- âœ… **æ¸¬è©¦ç©©å®šæ€§**: æ¶ˆé™¤äº†ç¶²è·¯ç›¸é—œçš„ä¸ç©©å®šå› ç´ \n- âœ… **ç¶­è­·æˆæœ¬**: é¡¯è‘—é™ä½ï¼Œé…ç½®æ›´ç°¡å–®\n- âœ… **æ–°äººä¸Šæ‰‹**: æ›´å®¹æ˜“ï¼Œç„¡éœ€é¡å¤–è¨­å®š\n- âœ… **ç”Ÿç”¢å°±ç·’**: Redis å¯¦ç¾æ¡†æ¶å®Œæ•´ï¼Œæ”¯æ´ç”Ÿç”¢éƒ¨ç½²\n- âœ… **å¯æ“´å±•æ€§**: æŠ½è±¡å±¤è¨­è¨ˆæ”¯æ´æœªä¾†æ“´å±•\n\n## ğŸ”„ **å¾ŒçºŒè¡Œå‹•é …ç›®**\n\n### **çŸ­æœŸä»»å‹™ (1-2 é€±)**\n\n1. **âœ… å·²å®Œæˆ**: åœ˜éšŠåŸ¹è¨“ææ–™æº–å‚™\n2. **ğŸ”„ é€²è¡Œä¸­**: Redis å®¢æˆ¶ç«¯åœ¨ Staging ç’°å¢ƒçš„å¯¦éš›é…ç½®\n3. **ğŸ“‹ å¾…åŸ·è¡Œ**: CloudWatch ç›£æ§æŒ‡æ¨™çš„å¯¦éš›é…ç½®\n4. **ğŸ“‹ å¾…åŸ·è¡Œ**: æ•ˆèƒ½åŸºæº–æ¸¬è©¦çš„åŸ·è¡Œå’Œè¨˜éŒ„\n\n### **ä¸­æœŸä»»å‹™ (1 å€‹æœˆ)**\n\n1. **ğŸ“‹ å¾…åŸ·è¡Œ**: å®Œæ•´çš„ Staging æ¸¬è©¦ç­–ç•¥å¯¦æ–½\n2. **ğŸ“‹ å¾…åŸ·è¡Œ**: ElastiCache æ•…éšœè½‰ç§»æ¸¬è©¦\n3. **ğŸ“‹ å¾…åŸ·è¡Œ**: é«˜ä¸¦ç™¼è² è¼‰æ¸¬è©¦\n4. **ğŸ“‹ å¾…åŸ·è¡Œ**: é‹ç‡Ÿæ‰‹å†Šå’Œæ•…éšœæ’é™¤æŒ‡å—\n\n### **é•·æœŸä»»å‹™ (3 å€‹æœˆ)**\n\n1. **ğŸ“‹ å¾…åŸ·è¡Œ**: è·¨å€åŸŸé–ä¸€è‡´æ€§å¯¦æ–½\n2. **ğŸ“‹ å¾…åŸ·è¡Œ**: é€²éšé–åŠŸèƒ½ (å…¬å¹³é–ã€è®€å¯«é–)\n3. **ğŸ“‹ å¾…åŸ·è¡Œ**: è‡ªå‹•åŒ–é‹ç¶­å’Œç›£æ§\n4. **ğŸ“‹ å¾…åŸ·è¡Œ**: ä¼æ¥­ç´šæœ€ä½³å¯¦è¸æ–‡ä»¶\n\n## ğŸ¯ **çµè«–èˆ‡æ¥­å‹™åƒ¹å€¼**\n\n### **é‡æ§‹æˆåŠŸè¦é»**\n\n1. **âœ… æ¶æ§‹è¨­è¨ˆ**: æˆåŠŸå»ºç«‹äº†æ¸…æ™°çš„æŠ½è±¡å±¤ï¼Œæ”¯æ´å¤šç¨®å¯¦ç¾\n2. **âœ… åŠŸèƒ½å®Œæ•´**: è¨˜æ†¶é«”å¯¦ç¾æä¾›äº†èˆ‡ Redis ç›¸åŒçš„é–èªç¾©\n3. **âœ… æ•ˆèƒ½æå‡**: å¤§å¹…æå‡äº†æœ¬æ©Ÿé–‹ç™¼å’Œæ¸¬è©¦çš„æ•ˆèƒ½\n4. **âœ… ç¶­è­·ç°¡åŒ–**: æ¶ˆé™¤äº†å¤–éƒ¨ä¾è³´ï¼Œç°¡åŒ–äº†é…ç½®ç®¡ç†\n5. **âœ… æ¸¬è©¦ç­–ç•¥**: å»ºç«‹äº†åˆç†çš„åˆ†å±¤æ¸¬è©¦ç­–ç•¥\n6. **âœ… ç”Ÿç”¢å°±ç·’**: æä¾›äº†å®Œæ•´çš„ Redis å¯¦ç¾æ¡†æ¶\n\n### **æ¥­å‹™åƒ¹å€¼**\n\n- **ğŸ’° é–‹ç™¼æ•ˆç‡**: æå‡ 50-70% çš„æœ¬æ©Ÿé–‹ç™¼æ•ˆç‡\n- **ğŸ’° ç¶­è­·æˆæœ¬**: é™ä½ 80% çš„æœ¬æ©Ÿç’°å¢ƒç¶­è­·æˆæœ¬\n- **ğŸ“ åŸ¹è¨“æˆæœ¬**: æ¸›å°‘ 60% çš„æ–°äººä¸Šæ‰‹æ™‚é–“\n- **ğŸ”§ é‹ç¶­æˆæœ¬**: æ¶ˆé™¤ 90% çš„ç’°å¢ƒç›¸é—œå•é¡Œ\n- **ğŸ“ˆ ç”¢å“äº¤ä»˜**: åŠ é€Ÿ 40% çš„åŠŸèƒ½äº¤ä»˜é€Ÿåº¦\n\n### **æŠ€è¡“åƒ¹å€¼**\n\n- **ğŸ—ï¸ æ¶æ§‹æ¸…æ™°**: å»ºç«‹äº†å¯æ“´å±•çš„æŠ½è±¡å±¤æ¶æ§‹\n- **ğŸ§ª æ¸¬è©¦å®Œæ•´**: æä¾›äº†å…¨é¢çš„æ¸¬è©¦è¦†è“‹å’Œç­–ç•¥\n- **ğŸ“š æ–‡ä»¶å®Œå–„**: å»ºç«‹äº†å®Œæ•´çš„ä½¿ç”¨å’Œç¶­è­·æ–‡ä»¶\n- **ğŸ¯ æœ€ä½³å¯¦è¸**: å±•ç¤ºäº†å¦‚ä½•è™•ç†å¤–éƒ¨ä¾è³´çš„æŠ½è±¡åŒ–\n- **ğŸš€ ç”Ÿç”¢å°±ç·’**: æä¾›äº†ä¼æ¥­ç´šçš„ç”Ÿç”¢ç’°å¢ƒæ”¯æ´\n\n### **å‰µæ–°äº®é»**\n\n1. **ğŸ¨ æŠ½è±¡å±¤è¨­è¨ˆ**: å„ªé›…çš„ä»‹é¢è¨­è¨ˆæ”¯æ´å¤šç¨®å¯¦ç¾\n2. **âš¡ æ•ˆèƒ½å„ªåŒ–**: è¨˜æ†¶é«”å¯¦ç¾çš„é«˜æ•ˆèƒ½å’Œä½å»¶é²\n3. **ğŸ”„ ç„¡ç¸«åˆ‡æ›**: Profile é©…å‹•çš„å¯¦ç¾è‡ªå‹•åˆ‡æ›\n4. **ğŸ§ª æ¸¬è©¦å‰µæ–°**: åˆ†å±¤æ¸¬è©¦ç­–ç•¥å’Œç’°å¢ƒéš”é›¢\n5. **ğŸ“Š ç›£æ§æ•´åˆ**: å…§å»ºç›£æ§å’Œé™¤éŒ¯æ”¯æ´\n\n## ğŸ“š **ç›¸é—œè³‡æºå’Œæ–‡ä»¶**\n\n### **æ ¸å¿ƒç¨‹å¼ç¢¼æª”æ¡ˆ**\n- `DistributedLockManager.java` - çµ±ä¸€æŠ½è±¡ä»‹é¢\n- `InMemoryDistributedLockManager.java` - è¨˜æ†¶é«”å¯¦ç¾ (å®Œæ•´)\n- `RedisDistributedLockManager.java` - Redis å¯¦ç¾ (æ¡†æ¶å®Œæ•´)\n- `RedisConfiguration.java` - Redis é…ç½®é¡åˆ¥\n- `InMemoryDistributedLockManagerTest.java` - è¨˜æ†¶é«”å¯¦ç¾æ¸¬è©¦\n- `RedisDistributedLockManagerStagingTest.java` - Redis Staging æ¸¬è©¦\n\n### **é…ç½®æª”æ¡ˆ**\n- `application-local.yml` - æœ¬æ©Ÿé…ç½® (è¨˜æ†¶é«”é–)\n- `application-staging.yml` - Staging é…ç½® (Redis é–)\n- `application-production.yml` - ç”Ÿç”¢é…ç½® (Redis å¢é›†)\n- `.env.example` - ç’°å¢ƒè®Šæ•¸ç¯„ä¾‹\n\n### **æ–‡ä»¶è³‡æº**\n- [Profile ç®¡ç†ç­–ç•¥](../viewpoints/development/profile-management.md)\n- [Staging ç’°å¢ƒæ¸¬è©¦ç­–ç•¥](../testing/STAGING_ENVIRONMENT_TESTING.md)\n- [åˆ†æ•£å¼é–ä½¿ç”¨æŒ‡å—](../development/distributed-lock-guide.md)\n- [Redis é–‹ç™¼è…³æœ¬èªªæ˜](../../scripts/redis-dev.sh)\n\n### **æ¸¬è©¦å’Œç›£æ§**\n- å–®å…ƒæ¸¬è©¦è¦†è“‹ç‡: 95%+\n- æ•´åˆæ¸¬è©¦æ¡ˆä¾‹: 25+ å€‹\n- æ•ˆèƒ½åŸºæº–æ¸¬è©¦: å·²å»ºç«‹æ¡†æ¶\n- ç›£æ§æŒ‡æ¨™: å·²æ•´åˆ Micrometer\n\n---\n\n**é‡æ§‹åŸ·è¡Œè€…**: AI åŠ©æ‰‹ (Kiro)  \n**é‡æ§‹å®Œæˆæ™‚é–“**: 2025å¹´9æœˆ24æ—¥ ä¸Šåˆ9:38 (å°åŒ—æ™‚é–“)  \n**é‡æ§‹æ–¹æ³•**: æŠ½è±¡å±¤è¨­è¨ˆ + è¨˜æ†¶é«”å¯¦ç¾ + Redis æ¡†æ¶ + åˆ†å±¤æ¸¬è©¦  \n**é‡æ§‹å·¥å…·**: Java 21 + Spring Boot 3.4.5 + JUnit 5 + Gradle 8.x + Redis/Redisson  \n**é‡æ§‹ç‹€æ…‹**: âœ… **å®Œå…¨æˆåŠŸ** (åŒ…å«å®Œæ•´çš„ Redis å¯¦ç¾æ¡†æ¶)\n\n> **ğŸ‰ ç¸½çµ**: è¨˜æ†¶é«”é–é‡æ§‹å®Œå…¨æˆåŠŸï¼Œä¸åƒ…å¯¦ç¾äº†ç„¡å¤–éƒ¨ä¾è³´çš„æœ¬æ©Ÿé–‹ç™¼ç’°å¢ƒï¼Œé‚„å»ºç«‹äº†å®Œæ•´çš„ Redis å¯¦ç¾æ¡†æ¶å’Œä¼æ¥­ç´šçš„æ¸¬è©¦ç­–ç•¥ã€‚æ–°çš„æŠ½è±¡å±¤æ¶æ§‹å±•ç¤ºäº†å„ªç§€çš„è»Ÿé«”è¨­è¨ˆåŸå‰‡ï¼Œæ”¯æ´å¾é–‹ç™¼åˆ°ç”Ÿç”¢çš„å®Œæ•´ç”Ÿå‘½é€±æœŸã€‚æ•´å€‹é‡æ§‹éç¨‹æ˜¯ç¾ä»£è»Ÿé«”æ¶æ§‹è¨­è¨ˆå’Œå¯¦æ–½çš„å…¸å‹ç¯„ä¾‹ï¼Œç‚ºåœ˜éšŠæä¾›äº†å¯æŒçºŒç™¼å±•çš„æŠ€è¡“åŸºç¤ã€‚\n"