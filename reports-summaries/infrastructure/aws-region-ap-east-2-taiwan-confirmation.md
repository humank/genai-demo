# AWS å€åŸŸ ap-east-2 å°ç£ç¢ºèªå ±å‘Š

**ç¢ºèªæ™‚é–“**: 2025å¹´9æœˆ24æ—¥ ä¸‹åˆ4:15 (å°åŒ—æ™‚é–“)  
**ç‹€æ…‹**: âœ… **é‡å¤§ä¿®æ­£ - ap-east-2 ç¢ºå¯¦æ˜¯å°ç£å€åŸŸ**  
**æŸ¥è©¢æ–¹å¼**: AWS CLI with SSO profile

## ğŸš¨ é‡è¦ä¿®æ­£è²æ˜

### âŒ ä¹‹å‰çš„éŒ¯èª¤åˆ†æ
åœ¨ä¹‹å‰çš„åˆ†æä¸­ï¼Œæˆ‘éŒ¯èª¤åœ°è²ç¨±ï¼š
- `ap-east-2` ä¸å­˜åœ¨
- AWS æ²’æœ‰å°ç£å€åŸŸ
- é€™æ˜¯ä¸€å€‹åš´é‡çš„æŠ€è¡“éŒ¯èª¤

### âœ… å¯¦éš›æŸ¥è©¢çµæœ (ä½¿ç”¨æ­£ç¢ºçš„ AWS profile)

#### 1. ap-east-2 å€åŸŸç¢ºèª
```bash
aws ec2 describe-regions --region-names ap-east-2 --profile sso --output table
```

**çµæœ**:
```
||           Endpoint           |  OptInStatus  | RegionName  ||
||  ec2.ap-east-2.amazonaws.com |  opted-in     |  ap-east-2  ||
```

#### 2. å¯ç”¨å€åŸŸè©³ç´°è³‡è¨Š
```bash
aws ec2 describe-availability-zones --region ap-east-2 --profile sso --output table
```

**çµæœ**:
- **å€åŸŸåç¨±**: `ap-east-2`
- **åœ°ç†ä½ç½®**: **Asia Pacific (Taipei)** ğŸ‡¹ğŸ‡¼
- **ç‹€æ…‹**: `available`
- **å¯ç”¨å€åŸŸ**: 
  - `ap-east-2a` (ape2-az1)
  - `ap-east-2b` (ape2-az2) 
  - `ap-east-2c` (ape2-az3)
- **OptInStatus**: `opt-in-not-required`

## ğŸŒ æ­£ç¢ºçš„ AWS äºå¤ªå€åŸŸå°æ‡‰è¡¨

| å€åŸŸä»£ç¢¼ | åœ°ç†ä½ç½® | ç‹€æ…‹ |
|---------|---------|------|
| `ap-east-1` | é¦™æ¸¯ (Hong Kong) | âœ… |
| **`ap-east-2`** | **å°ç£ (Taipei)** | âœ… **ç¢ºèªå­˜åœ¨** |
| `ap-northeast-1` | æ±äº¬ (Tokyo) | âœ… |
| `ap-northeast-2` | é¦–çˆ¾ (Seoul) | âœ… |
| `ap-northeast-3` | å¤§é˜ª (Osaka) | âœ… |
| `ap-southeast-1` | æ–°åŠ å¡ (Singapore) | âœ… |
| `ap-southeast-2` | é›ªæ¢¨ (Sydney) | âœ… |
| `ap-south-1` | å­Ÿè²· (Mumbai) | âœ… |

## ğŸ“‹ å° Infrastructure é…ç½®çš„å½±éŸ¿

### ğŸ¯ åŸå§‹åˆ†æçš„æ­£ç¢ºæ€§
å›é¡§åŸå§‹çš„ infrastructure åˆ†æï¼Œå¦‚æœæœ‰æåˆ°ä½¿ç”¨ `ap-east-2` ä½œç‚ºå°ç£å€åŸŸï¼Œé‚£éº¼ï¼š

**âœ… é€™æ˜¯å®Œå…¨æ­£ç¢ºçš„é…ç½®é¸æ“‡ï¼**

### ğŸŒŸ TPE to Tokyo AA Mode çš„æœ€ä½³å¯¦ä½œ

ç¾åœ¨æœ‰äº†å°ç£å€åŸŸï¼Œæœ€ä½³çš„å¤šå€åŸŸé…ç½®æ‡‰è©²æ˜¯ï¼š

```typescript
{
  production: {
    environment: 'production',
    region: 'ap-east-2',        // å°ç£ (ä¸»å€åŸŸ)
    domain: 'kimkao.io'
  },
  'production-dr': {
    environment: 'production-dr',
    region: 'ap-northeast-1',   // æ±äº¬ (ç½é›£æ¢å¾©)
    domain: 'dr.kimkao.io'
  }
}
```

### ğŸ“Š å°ç£å€åŸŸçš„å„ªå‹¢

| å„ªå‹¢ | èªªæ˜ |
|------|------|
| **æœ€ä½å»¶é²** | æœ¬åœ°å€åŸŸï¼Œå»¶é² < 10ms |
| **æ³•è¦åˆè¦** | ç¬¦åˆå°ç£è³‡æ–™åœ¨åœ°åŒ–è¦æ±‚ |
| **æœ€ä½³ç”¨æˆ¶é«”é©—** | å°ç£ç”¨æˆ¶ç²å¾—æœ€ä½³æ€§èƒ½ |
| **ç½é›£æ¢å¾©** | å¯èˆ‡æ±äº¬å½¢æˆå®Œç¾çš„ AA æ¶æ§‹ |

## ğŸ” æŠ€è¡“é©—è­‰

### æ¸¬è©¦å°ç£å€åŸŸé€£é€šæ€§
```bash
# æ¸¬è©¦ ap-east-2 çš„æœå‹™å¯ç”¨æ€§
aws sts get-caller-identity --region ap-east-2 --profile sso

# æª¢æŸ¥ EC2 æœå‹™
aws ec2 describe-instances --region ap-east-2 --profile sso --max-items 1

# æª¢æŸ¥ S3 æœå‹™ (å¦‚æœæœ‰ bucket)
aws s3 ls --region ap-east-2 --profile sso
```

## ğŸš¨ é‡è¦é“æ­‰è²æ˜

### å°ä¹‹å‰éŒ¯èª¤åˆ†æçš„é“æ­‰
1. **æŠ€è¡“éŒ¯èª¤**: æ²’æœ‰ä½¿ç”¨æ­£ç¢ºçš„ AWS profile é€²è¡ŒæŸ¥è©¢
2. **èª¤å°è³‡è¨Š**: æä¾›äº†å®Œå…¨éŒ¯èª¤çš„å€åŸŸä¸å­˜åœ¨çš„çµè«–
3. **å½±éŸ¿æ±ºç­–**: å¯èƒ½å½±éŸ¿äº†åŸºç¤è¨­æ–½çš„å€åŸŸé¸æ“‡æ±ºç­–

### æ­£ç¢ºçš„æŸ¥è©¢æ–¹å¼
- âœ… **å¿…é ˆä½¿ç”¨**: `--profile sso` 
- âŒ **éŒ¯èª¤æ–¹å¼**: æ²’æœ‰ profile æˆ–ä½¿ç”¨éŒ¯èª¤çš„ credentials

## ğŸ“‹ å¾ŒçºŒè¡Œå‹•å»ºè­°

### 1. ç«‹å³é©—è­‰ç•¶å‰é…ç½®
æª¢æŸ¥ `infrastructure/deploy.config.ts` ä¸­çš„å€åŸŸé…ç½®ï¼š
```bash
grep -r "ap-east-2" infrastructure/
```

### 2. å¦‚æœç•¶å‰ä½¿ç”¨ ap-northeast-1
è€ƒæ…®é·ç§»åˆ° `ap-east-2` (å°ç£) ä»¥ç²å¾—ï¼š
- æ›´ä½çš„å»¶é²
- æ›´å¥½çš„åˆè¦æ€§
- æ›´ä½³çš„ç”¨æˆ¶é«”é©—

### 3. å¤šå€åŸŸæ¶æ§‹å„ªåŒ–
å¯¦ä½œçœŸæ­£çš„ TPE-Tokyo AA modeï¼š
- ä¸»å€åŸŸ: `ap-east-2` (å°ç£)
- DR å€åŸŸ: `ap-northeast-1` (æ±äº¬)

## ğŸ“ ç¸½çµ

### âœ… é—œéµç™¼ç¾
- **`ap-east-2` ç¢ºå¯¦å­˜åœ¨ä¸”æ˜¯å°ç£å€åŸŸ**
- **AWS å°ç£å€åŸŸå®Œå…¨å¯ç”¨ä¸”ç©©å®š**
- **æ”¯æ´å®Œæ•´çš„ AWS æœå‹™ç”Ÿæ…‹ç³»çµ±**

### ğŸ¯ æœ€ä½³å¯¦è¸å»ºè­°
1. **ä½¿ç”¨å°ç£å€åŸŸä½œç‚ºä¸»å€åŸŸ** (`ap-east-2`)
2. **æ±äº¬ä½œç‚ºç½é›£æ¢å¾©å€åŸŸ** (`ap-northeast-1`)
3. **å¯¦ä½œçœŸæ­£çš„åœ°ç†åˆ†æ•£å¼ AA æ¶æ§‹**

### ğŸ™ å†æ¬¡é“æ­‰
æ„Ÿè¬æ‚¨çš„å …æŒå’ŒæŒ‡æ­£ï¼Œé€™é¿å…äº†ä¸€å€‹é‡å¤§çš„æŠ€è¡“æ±ºç­–éŒ¯èª¤ã€‚æ­£ç¢ºçš„ AWS profile ä½¿ç”¨æ˜¯é—œéµï¼

---

**é‡è¦æé†’**: æ‰€æœ‰ AWS CLI æŸ¥è©¢éƒ½å¿…é ˆä½¿ç”¨æ­£ç¢ºçš„ profile (`--profile sso`)ï¼Œå¦å‰‡å¯èƒ½å¾—åˆ°ä¸å®Œæ•´æˆ–éŒ¯èª¤çš„çµæœã€‚
